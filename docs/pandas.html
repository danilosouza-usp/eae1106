<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Danilo Souza">

<title>8&nbsp; Gestão e análise de dados – Métodos Computacionais para Economia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./visualizacao.html" rel="next">
<link href="./numpy.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-68c8bffd90dad8f2b55c52d7b6410dc0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-41be9fc20d951fc824f2d866d6c048cc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pacotes.html">Computação numérica, análise de dados e visualização</a></li><li class="breadcrumb-item"><a href="./pandas.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gestão e análise de dados</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/usp-logo.jpg" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./images/usp-logo.jpg" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Métodos Computacionais para Economia</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/danilosouza-usp/eae1106" title="Código fonte" class="quarto-navigation-tool px-1" aria-label="Código fonte"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sobre este material</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prefacio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./alfabetizacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alfabetização computacional e lógica básica</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fundamentos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Fundamentos de computação</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primeiros_passos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Primeiros passos no Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inteligencia_artificial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Programação e IA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objetos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tipos primitivos e objetos básicos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iteracao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Controle de fluxo e iteração</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./funcoes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Funções</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pacotes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computação numérica, análise de dados e visualização</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Arrays, matrizes e álgebra linear</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pandas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gestão e análise de dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualizacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualização</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projeto_empirico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Análise empírica integrada</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./complemento.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Temas complementares</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./oop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introdução à programação orientada a objetos (OOP)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intror.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introdução ao R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografia</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#o-que-é-o-pandas" id="toc-o-que-é-o-pandas" class="nav-link active" data-scroll-target="#o-que-é-o-pandas"><span class="header-section-number">8.1</span> O que é o Pandas?</a></li>
  <li><a href="#objetos-no-pandas" id="toc-objetos-no-pandas" class="nav-link" data-scroll-target="#objetos-no-pandas"><span class="header-section-number">8.2</span> Objetos no Pandas</a></li>
  <li><a href="#dataframes-o-coração-do-pandas" id="toc-dataframes-o-coração-do-pandas" class="nav-link" data-scroll-target="#dataframes-o-coração-do-pandas"><span class="header-section-number">8.3</span> <em>DataFrames</em>: o coração do Pandas</a>
  <ul class="collapse">
  <li><a href="#importação-de-dados-externos" id="toc-importação-de-dados-externos" class="nav-link" data-scroll-target="#importação-de-dados-externos"><span class="header-section-number">8.3.1</span> Importação de dados externos</a></li>
  <li><a href="#características-básicas" id="toc-características-básicas" class="nav-link" data-scroll-target="#características-básicas"><span class="header-section-number">8.3.2</span> Características básicas</a></li>
  <li><a href="#indexação-seleção-e-filtragem" id="toc-indexação-seleção-e-filtragem" class="nav-link" data-scroll-target="#indexação-seleção-e-filtragem"><span class="header-section-number">8.3.3</span> Indexação, seleção e filtragem</a></li>
  <li><a href="#operações-com-colunas-numéricas" id="toc-operações-com-colunas-numéricas" class="nav-link" data-scroll-target="#operações-com-colunas-numéricas"><span class="header-section-number">8.3.4</span> Operações com colunas numéricas</a></li>
  <li><a href="#operações-com-colunas-contendo-strings" id="toc-operações-com-colunas-contendo-strings" class="nav-link" data-scroll-target="#operações-com-colunas-contendo-strings"><span class="header-section-number">8.3.5</span> Operações com colunas contendo strings</a></li>
  <li><a href="#agrupamento-e-junção-de-dataframes" id="toc-agrupamento-e-junção-de-dataframes" class="nav-link" data-scroll-target="#agrupamento-e-junção-de-dataframes"><span class="header-section-number">8.3.6</span> Agrupamento e junção de DataFrames</a></li>
  <li><a href="#exportando-o-dataframe" id="toc-exportando-o-dataframe" class="nav-link" data-scroll-target="#exportando-o-dataframe"><span class="header-section-number">8.3.7</span> Exportando o DataFrame</a></li>
  </ul></li>
  <li><a href="#eficiência-e-dtypes" id="toc-eficiência-e-dtypes" class="nav-link" data-scroll-target="#eficiência-e-dtypes"><span class="header-section-number">8.4</span> Eficiência e <em>dtypes</em></a></li>
  <li><a href="#exercícios" id="toc-exercícios" class="nav-link" data-scroll-target="#exercícios"><span class="header-section-number">8.5</span> Exercícios</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/danilosouza-usp/eae1106/edit/main/pandas.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li><li><a href="https://github.com/danilosouza-usp/eae1106/issues/new" class="toc-action"><i class="bi empty"></i>Criar uma issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pacotes.html">Computação numérica, análise de dados e visualização</a></li><li class="breadcrumb-item"><a href="./pandas.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gestão e análise de dados</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-pandas" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gestão e análise de dados</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Uma das principais aplicações para o Python bla bla bla</p>
<section id="o-que-é-o-pandas" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="o-que-é-o-pandas"><span class="header-section-number">8.1</span> O que é o Pandas?</h2>
<p>Pandas é uma biblioteca que contém objetos específicos e ferramentas próprias a esses objetos que permitem realizar limpeza, organização e análise de dados de forma bastante eficiente no Python. Não à toa, é uma das bibliotecas mais utilizadas na linguagem hoje em dia, um pré-requisito para a maior parte das aplicações de ciência dos dados e aprendizado de máquina.</p>
<p>Embora o Pandas se utilize em grande medida da estrutura e lógica do NumPy e seus arrays, a biblioteca é projetada para trabalhar com dados tabulares e heterogêneos. Como já vimos, o NumPy é mais adequado para trabalhar com dados homogêneos e em sua maior parte numéricos.</p>
<p>São dois os objetos particulares ao Pandas: <code>Series</code> e <code>DataFrame</code>.</p>
<p>Você pode pensar em uma série como uma “coluna” de dados, como uma sequência de observações em uma única variável. Por outro lado, um DataFrame é um objeto bidimensional para armazenar colunas de dados relacionadas, assim como uma tabela, com linhas e colunas, no Microsoft Excel.</p>
</section>
<section id="objetos-no-pandas" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="objetos-no-pandas"><span class="header-section-number">8.2</span> Objetos no Pandas</h2>
<p>Primeiro passo é importar o Pandas.</p>
<div id="232ef85e" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Uma vez importado, vamos começar criando duas listas: uma contendo o número de pessoas ocupadas (em mil pessoas) no Brasil de 2012 a 2021 e outra contendo exatamente o intervalo de anos.</p>
<div id="2b14684b" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pessoas_ocupadas <span class="op">=</span> [<span class="dv">90593</span>,<span class="dv">92170</span>,<span class="dv">92962</span>,<span class="dv">92366</span>,<span class="dv">90174</span>,<span class="dv">92228</span>,<span class="dv">93534</span>,<span class="dv">95515</span>,<span class="dv">87225</span>,<span class="dv">95747</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>anos <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2012</span>,<span class="dv">2021</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pessoas_ocupadas)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anos)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[90593, 92170, 92962, 92366, 90174, 92228, 93534, 95515, 87225, 95747]
[2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021]</code></pre>
</div>
</div>
<p>Para criar uma série basta utilizar a função <code>pandas.Series</code>, que recebe como argumento os valores da série e os índices da série, que serão justamente os valores que identificam cada linha.</p>
<div id="fcb1ca71" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>series_pessoas_ocup <span class="op">=</span> pd.Series(data<span class="op">=</span>pessoas_ocupadas,index<span class="op">=</span>anos)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(series_pessoas_ocup),<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(series_pessoas_ocup)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.series.Series'&gt; 

2012    90593
2013    92170
2014    92962
2015    92366
2016    90174
2017    92228
2018    93534
2019    95515
2020    87225
2021    95747
dtype: int64</code></pre>
</div>
</div>
<p>Já para o caso de um DataFrame, podemos criá-lo através da função <code>pandas.DataFrame</code>. Essa função recebe os dados que irão compor as colunas de dados de diversas formas, mas umas das mais intuitivas é através da utilização de dicionários. Seguindo o exemplo anterior, vamos criar um DataFrame com as informações de pessoas ocupadas, desocupadas, dentro e fora da força de trabalho.</p>
<p>Primeiro passo é definir o dicionário com esses dados.</p>
<div id="211e9ec3" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dados <span class="op">=</span> {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ocupadas'</span>: [<span class="dv">90593</span>,<span class="dv">92170</span>,<span class="dv">92962</span>,<span class="dv">92366</span>,<span class="dv">90174</span>,<span class="dv">92228</span>,<span class="dv">93534</span>,<span class="dv">95515</span>,<span class="dv">87225</span>,<span class="dv">95747</span>],</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'desocupadas'</span>: [<span class="dv">6730</span>,<span class="dv">6151</span>,<span class="dv">6555</span>,<span class="dv">9222</span>,<span class="dv">12476</span>,<span class="dv">12453</span>,<span class="dv">12413</span>,<span class="dv">11903</span>,<span class="dv">14412</span>,<span class="dv">12011</span>],</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'na forca'</span>: [<span class="dv">97322</span>,<span class="dv">98321</span>,<span class="dv">99516</span>,<span class="dv">101588</span>,<span class="dv">102650</span>,<span class="dv">104682</span>,<span class="dv">105947</span>,<span class="dv">107418</span>,<span class="dv">101637</span>,<span class="dv">107758</span>],</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'fora da forca'</span>: [<span class="dv">58007</span>,<span class="dv">59244</span>,<span class="dv">60162</span>,<span class="dv">60092</span>,<span class="dv">60953</span>,<span class="dv">60777</span>,<span class="dv">61299</span>,<span class="dv">61579</span>,<span class="dv">69042</span>,<span class="dv">64525</span>]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dados)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'ocupadas': [90593, 92170, 92962, 92366, 90174, 92228, 93534, 95515, 87225, 95747], 'desocupadas': [6730, 6151, 6555, 9222, 12476, 12453, 12413, 11903, 14412, 12011], 'na forca': [97322, 98321, 99516, 101588, 102650, 104682, 105947, 107418, 101637, 107758], 'fora da forca': [58007, 59244, 60162, 60092, 60953, 60777, 61299, 61579, 69042, 64525]}</code></pre>
</div>
</div>
<p>Agora basta definir o DataFrame usando como argumento esse dicionários <code>dados</code>.</p>
<div id="508e532d" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dados_emprego <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>dados,index<span class="op">=</span>anos)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(dados_emprego),<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>dados_emprego</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt; 
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ocupadas</th>
<th data-quarto-table-cell-role="th">desocupadas</th>
<th data-quarto-table-cell-role="th">na forca</th>
<th data-quarto-table-cell-role="th">fora da forca</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2012</th>
<td>90593</td>
<td>6730</td>
<td>97322</td>
<td>58007</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2013</th>
<td>92170</td>
<td>6151</td>
<td>98321</td>
<td>59244</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2014</th>
<td>92962</td>
<td>6555</td>
<td>99516</td>
<td>60162</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2015</th>
<td>92366</td>
<td>9222</td>
<td>101588</td>
<td>60092</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2016</th>
<td>90174</td>
<td>12476</td>
<td>102650</td>
<td>60953</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2017</th>
<td>92228</td>
<td>12453</td>
<td>104682</td>
<td>60777</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2018</th>
<td>93534</td>
<td>12413</td>
<td>105947</td>
<td>61299</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2019</th>
<td>95515</td>
<td>11903</td>
<td>107418</td>
<td>61579</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2020</th>
<td>87225</td>
<td>14412</td>
<td>101637</td>
<td>69042</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2021</th>
<td>95747</td>
<td>12011</td>
<td>107758</td>
<td>64525</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="dataframes-o-coração-do-pandas" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="dataframes-o-coração-do-pandas"><span class="header-section-number">8.3</span> <em>DataFrames</em>: o coração do Pandas</h2>
<section id="importação-de-dados-externos" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="importação-de-dados-externos"><span class="header-section-number">8.3.1</span> Importação de dados externos</h3>
<p>Agora que já apresentamos os dois tipos de objetos e como criá-los na mão, vamos avançar e trabalhar com dados trazidos de algum arquivo externo. É comum nos depararmos com arquivos do tipo <code>.csv</code> e é com ele que trabalharemos no Pandas, embora o Pandas seja flexível e nos permita trazer para dentro do Python arquivos de várias terminações como <code>.txt</code>, <code>.xlsx</code>, <code>.json</code>, <code>.dta</code>, etc.</p>
<p>A ideia daqui para frente é trabalhar com os dados do site <a href="https://ourworldindata.org/">Our World in Data</a> sobre número de casos de covid-19, mortes e excesso de mortes atrelados à doença, e número de doses de vacina aplicadas ao redor do mundo desde o início da pandemia, em fevereiro de 2020. Esses dados são atualizados semanalmente e disponibilizados na plataforma Kaggle. O arquivo específico com o qual trabalharemos está disponível no Moodle e deve ser baixado para a sua máquina local.</p>
<p>Mas antes de aprendermos como trabalhar com um dataframe e as funcionalidades que o Pandas nos traz precisamos ler o arquivo com os nossos dados. Comecemos pela função <code>os.chdir</code> do pacote <code>os</code> para mudar o diretório base do Python para o diretório no qual o nosso arquivo se encontra:</p>
<div id="931a6c27" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Qual o diretório no qual o Python está trabalhando? A função getcwd() nos diz isso</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Diretório inicial: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(os.getcwd()))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vamos mudar para o nosso diretório atual</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">'D:/Dropbox/Projetos e trabalhos/FEAUSP/Cursos/EAE1106 - Metodos Computacionais para Economistas/Aulas/2024_2'</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Diretório final: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(os.getcwd()))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Diretório inicial: D:\Dropbox\Projetos e trabalhos\FEAUSP\Cursos\EAE1106 - Metodos Computacionais para Economistas\Book\eae1106
Diretório final: D:\Dropbox\Projetos e trabalhos\FEAUSP\Cursos\EAE1106 - Metodos Computacionais para Economistas\Aulas\2024_2</code></pre>
</div>
</div>
<p>Quais são os arquivos disponíveis nesse diretório? A função <code>os.listdir()</code> lista as pastas e arquivos disponíveis no diretório que estamos trabalhando.</p>
<div id="aec85b59" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>os.listdir()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>['df_resultado_aula_pandas.csv',
 'EAE1106 - Aula Fundamentos.html',
 'EAE1106 - Aula Fundamentos.pdf',
 'EAE1106 - Aula Funções.html',
 'EAE1106 - Aula Funções.pdf',
 'EAE1106 - Aula Instalação.html',
 'EAE1106 - Aula Instalação.pdf',
 'EAE1106 - Aula Iteração.html',
 'EAE1106 - Aula Iteração.pdf',
 'EAE1106 - Aula Matplotlib.html',
 'EAE1106 - Aula Matplotlib.pdf',
 'EAE1106 - Aula NumPy.html',
 'EAE1106 - Aula NumPy.pdf',
 'EAE1106 - Aula Objetos.html',
 'EAE1106 - Aula Objetos.pdf',
 'EAE1106 - Aula Pandas.html',
 'EAE1106 - Aula Pandas.pdf',
 'EAE1106_Fundamentos_slides.aux',
 'EAE1106_Fundamentos_slides.log',
 'EAE1106_Fundamentos_slides.nav',
 'EAE1106_Fundamentos_slides.out',
 'EAE1106_Fundamentos_slides.pdf',
 'EAE1106_Fundamentos_slides.snm',
 'EAE1106_Fundamentos_slides.synctex.gz',
 'EAE1106_Fundamentos_slides.tex',
 'EAE1106_Fundamentos_slides.toc',
 'EAE1106_Introducao_slides.aux',
 'EAE1106_Introducao_slides.log',
 'EAE1106_Introducao_slides.nav',
 'EAE1106_Introducao_slides.out',
 'EAE1106_Introducao_slides.pdf',
 'EAE1106_Introducao_slides.snm',
 'EAE1106_Introducao_slides.synctex.gz',
 'EAE1106_Introducao_slides.tex',
 'EAE1106_Introducao_slides.toc',
 'notebook_images',
 'owid-covid-data_top10.csv']</code></pre>
</div>
</div>
<p>Legal, Agora utilizaremos a função <code>pandas.read_csv</code> para ler o arquivo <code>owid-covid-data_top10.csv</code>. Esse arquivo contém as informações para os 10 países com o maior número reportado de casos de covid-19.</p>
<div id="ddd046f0" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_covid <span class="op">=</span> pd.read_csv(<span class="st">'owid-covid-data_top10.csv'</span>, sep<span class="op">=</span><span class="st">','</span>, encoding<span class="op">=</span><span class="st">'utf8'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(df_covid)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
</section>
<section id="características-básicas" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="características-básicas"><span class="header-section-number">8.3.2</span> Características básicas</h3>
<p>Alguns métodos específicos ao objeto DataFrame nos são incrivelmente úteis quando queremos ter uma leitura rápida do que acabamos de gerar.</p>
<ul>
<li><code>df.info()</code> nos retorna algumas informações técnicas do dataframe <code>df</code>, como o formato dos dados presentes em cada coluna.</li>
<li><code>df.head(n)</code> e <code>df.tail(n)</code> nos retornam as <code>n</code> primeiras e <code>n</code> últimas linhas, respectivamente.</li>
<li><code>df.describe()</code> nos retorna uma tabela de estatísticas descritivas das colunas numéricas.</li>
</ul>
<p>Vejamos o que esses métodos nos retornam no nosso caso:</p>
<div id="92818290" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_covid.info(memory_usage<span class="op">=</span><span class="st">'deep'</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 7663 entries, 0 to 7662
Data columns (total 67 columns):
 #   Column                                      Non-Null Count  Dtype  
---  ------                                      --------------  -----  
 0   iso_code                                    7663 non-null   object 
 1   continent                                   7663 non-null   object 
 2   location                                    7663 non-null   object 
 3   date                                        7663 non-null   object 
 4   total_cases                                 7663 non-null   float64
 5   new_cases                                   7641 non-null   float64
 6   new_cases_smoothed                          7484 non-null   float64
 7   total_deaths                                7345 non-null   float64
 8   new_deaths                                  7327 non-null   float64
 9   new_deaths_smoothed                         7173 non-null   float64
 10  total_cases_per_million                     7663 non-null   float64
 11  new_cases_per_million                       7641 non-null   float64
 12  new_cases_smoothed_per_million              7484 non-null   float64
 13  total_deaths_per_million                    7345 non-null   float64
 14  new_deaths_per_million                      7327 non-null   float64
 15  new_deaths_smoothed_per_million             7173 non-null   float64
 16  reproduction_rate                           7292 non-null   float64
 17  icu_patients                                4278 non-null   float64
 18  icu_patients_per_million                    4278 non-null   float64
 19  hosp_patients                               2861 non-null   float64
 20  hosp_patients_per_million                   2861 non-null   float64
 21  weekly_icu_admissions                       1377 non-null   float64
 22  weekly_icu_admissions_per_million           1377 non-null   float64
 23  weekly_hosp_admissions                      3603 non-null   float64
 24  weekly_hosp_admissions_per_million          3603 non-null   float64
 25  new_tests                                   5755 non-null   float64
 26  total_tests                                 6056 non-null   float64
 27  total_tests_per_thousand                    6056 non-null   float64
 28  new_tests_per_thousand                      5755 non-null   float64
 29  new_tests_smoothed                          7116 non-null   float64
 30  new_tests_smoothed_per_thousand             7116 non-null   float64
 31  positive_rate                               5812 non-null   float64
 32  tests_per_case                              5812 non-null   float64
 33  tests_units                                 7186 non-null   object 
 34  total_vaccinations                          3950 non-null   float64
 35  people_vaccinated                           3938 non-null   float64
 36  people_fully_vaccinated                     3860 non-null   float64
 37  total_boosters                              2070 non-null   float64
 38  new_vaccinations                            3858 non-null   float64
 39  new_vaccinations_smoothed                   4181 non-null   float64
 40  total_vaccinations_per_hundred              3950 non-null   float64
 41  people_vaccinated_per_hundred               3938 non-null   float64
 42  people_fully_vaccinated_per_hundred         3860 non-null   float64
 43  total_boosters_per_hundred                  2070 non-null   float64
 44  new_vaccinations_smoothed_per_million       4181 non-null   float64
 45  new_people_vaccinated_smoothed              4181 non-null   float64
 46  new_people_vaccinated_smoothed_per_hundred  4181 non-null   float64
 47  stringency_index                            7580 non-null   float64
 48  population                                  7663 non-null   float64
 49  population_density                          7663 non-null   float64
 50  median_age                                  7663 non-null   float64
 51  aged_65_older                               7663 non-null   float64
 52  aged_70_older                               7663 non-null   float64
 53  gdp_per_capita                              7663 non-null   float64
 54  extreme_poverty                             5348 non-null   float64
 55  cardiovasc_death_rate                       7663 non-null   float64
 56  diabetes_prevalence                         7663 non-null   float64
 57  female_smokers                              7663 non-null   float64
 58  male_smokers                                7663 non-null   float64
 59  handwashing_facilities                      766 non-null    float64
 60  hospital_beds_per_thousand                  7663 non-null   float64
 61  life_expectancy                             7663 non-null   float64
 62  human_development_index                     7663 non-null   float64
 63  excess_mortality_cumulative_absolute        692 non-null    float64
 64  excess_mortality_cumulative                 692 non-null    float64
 65  excess_mortality                            692 non-null    float64
 66  excess_mortality_cumulative_per_million     692 non-null    float64
dtypes: float64(62), object(5)
memory usage: 5.7 MB</code></pre>
</div>
</div>
<div id="718aa7da" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_covid.head(<span class="dv">2</span>) <span class="co"># método para apresentar apenas as primeiras duas linhas do dataframe</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2 rows × 67 columns</p>
</div>
</div>
</div>
<p>Ué, mas não são 67 colunas? Onde estão todas elas? Por padrão o pandas mostra apenas uma parcela do total, para alterar essas opções basta utilizar a função <code>pd.set_option</code> e mudar o argumento relacionado ao número máximo de colunas.</p>
<div id="c25247e7" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="dv">100</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_covid.head(<span class="dv">2</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">total_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">total_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">reproduction_rate</th>
<th data-quarto-table-cell-role="th">icu_patients</th>
<th data-quarto-table-cell-role="th">icu_patients_per_million</th>
<th data-quarto-table-cell-role="th">hosp_patients</th>
<th data-quarto-table-cell-role="th">hosp_patients_per_million</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions_per_million</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions_per_million</th>
<th data-quarto-table-cell-role="th">new_tests</th>
<th data-quarto-table-cell-role="th">total_tests</th>
<th data-quarto-table-cell-role="th">total_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed_per_thousand</th>
<th data-quarto-table-cell-role="th">positive_rate</th>
<th data-quarto-table-cell-role="th">tests_per_case</th>
<th data-quarto-table-cell-role="th">tests_units</th>
<th data-quarto-table-cell-role="th">total_vaccinations</th>
<th data-quarto-table-cell-role="th">people_vaccinated</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated</th>
<th data-quarto-table-cell-role="th">total_boosters</th>
<th data-quarto-table-cell-role="th">new_vaccinations</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed</th>
<th data-quarto-table-cell-role="th">total_vaccinations_per_hundred</th>
<th data-quarto-table-cell-role="th">people_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">total_boosters_per_hundred</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed_per_hundred</th>
<th data-quarto-table-cell-role="th">stringency_index</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">population_density</th>
<th data-quarto-table-cell-role="th">median_age</th>
<th data-quarto-table-cell-role="th">aged_65_older</th>
<th data-quarto-table-cell-role="th">aged_70_older</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">extreme_poverty</th>
<th data-quarto-table-cell-role="th">cardiovasc_death_rate</th>
<th data-quarto-table-cell-role="th">diabetes_prevalence</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.005</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="3bdae0ad" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_covid.describe()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">total_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">total_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">reproduction_rate</th>
<th data-quarto-table-cell-role="th">icu_patients</th>
<th data-quarto-table-cell-role="th">icu_patients_per_million</th>
<th data-quarto-table-cell-role="th">hosp_patients</th>
<th data-quarto-table-cell-role="th">hosp_patients_per_million</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions_per_million</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions_per_million</th>
<th data-quarto-table-cell-role="th">new_tests</th>
<th data-quarto-table-cell-role="th">total_tests</th>
<th data-quarto-table-cell-role="th">total_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed_per_thousand</th>
<th data-quarto-table-cell-role="th">positive_rate</th>
<th data-quarto-table-cell-role="th">tests_per_case</th>
<th data-quarto-table-cell-role="th">total_vaccinations</th>
<th data-quarto-table-cell-role="th">people_vaccinated</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated</th>
<th data-quarto-table-cell-role="th">total_boosters</th>
<th data-quarto-table-cell-role="th">new_vaccinations</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed</th>
<th data-quarto-table-cell-role="th">total_vaccinations_per_hundred</th>
<th data-quarto-table-cell-role="th">people_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">total_boosters_per_hundred</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed_per_hundred</th>
<th data-quarto-table-cell-role="th">stringency_index</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">population_density</th>
<th data-quarto-table-cell-role="th">median_age</th>
<th data-quarto-table-cell-role="th">aged_65_older</th>
<th data-quarto-table-cell-role="th">aged_70_older</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">extreme_poverty</th>
<th data-quarto-table-cell-role="th">cardiovasc_death_rate</th>
<th data-quarto-table-cell-role="th">diabetes_prevalence</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>7.663000e+03</td>
<td>7.641000e+03</td>
<td>7484.000000</td>
<td>7345.000000</td>
<td>7327.000000</td>
<td>7173.000000</td>
<td>7663.000000</td>
<td>7641.000000</td>
<td>7484.000000</td>
<td>7345.000000</td>
<td>7327.000000</td>
<td>7173.000000</td>
<td>7292.00000</td>
<td>4278.000000</td>
<td>4278.000000</td>
<td>2861.000000</td>
<td>2861.000000</td>
<td>1377.000000</td>
<td>1377.000000</td>
<td>3603.000000</td>
<td>3603.000000</td>
<td>5.755000e+03</td>
<td>6.056000e+03</td>
<td>6056.000000</td>
<td>5755.000000</td>
<td>7.116000e+03</td>
<td>7116.000000</td>
<td>5812.000000</td>
<td>5812.000000</td>
<td>3.950000e+03</td>
<td>3.938000e+03</td>
<td>3.860000e+03</td>
<td>2.070000e+03</td>
<td>3.858000e+03</td>
<td>4.181000e+03</td>
<td>3950.000000</td>
<td>3938.000000</td>
<td>3860.000000</td>
<td>2070.000000</td>
<td>4181.000000</td>
<td>4.181000e+03</td>
<td>4181.000000</td>
<td>7580.000000</td>
<td>7.663000e+03</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>5348.000000</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>7.660000e+02</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>7663.000000</td>
<td>6.920000e+02</td>
<td>692.000000</td>
<td>692.000000</td>
<td>692.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>7.413453e+06</td>
<td>3.248569e+04</td>
<td>32590.349244</td>
<td>143683.851464</td>
<td>420.451071</td>
<td>423.776663</td>
<td>40129.002883</td>
<td>218.335670</td>
<td>215.706487</td>
<td>849.127797</td>
<td>2.393236</td>
<td>2.408332</td>
<td>1.10120</td>
<td>3303.139551</td>
<td>24.102691</td>
<td>22806.165676</td>
<td>194.417561</td>
<td>1051.387073</td>
<td>15.427283</td>
<td>14677.353039</td>
<td>104.734778</td>
<td>4.813446e+05</td>
<td>1.227599e+08</td>
<td>770.611446</td>
<td>3.373291</td>
<td>4.273001e+05</td>
<td>3.038345</td>
<td>0.057080</td>
<td>56.352392</td>
<td>1.733269e+08</td>
<td>9.999566e+07</td>
<td>6.865947e+07</td>
<td>1.426021e+07</td>
<td>9.534017e+05</td>
<td>9.135433e+05</td>
<td>87.762058</td>
<td>45.944375</td>
<td>36.591272</td>
<td>13.227155</td>
<td>4397.336283</td>
<td>4.408262e+05</td>
<td>0.183069</td>
<td>58.892639</td>
<td>2.540772e+08</td>
<td>224.299485</td>
<td>40.885972</td>
<td>16.819120</td>
<td>11.279442</td>
<td>33434.062213</td>
<td>4.037939</td>
<td>168.227080</td>
<td>7.011014</td>
<td>17.022224</td>
<td>31.774449</td>
<td>5.955000e+01</td>
<td>5.882298</td>
<td>79.370521</td>
<td>0.867278</td>
<td>1.277382e+05</td>
<td>7.168382</td>
<td>10.014639</td>
<td>868.361431</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>1.200763e+07</td>
<td>6.990790e+04</td>
<td>66130.926542</td>
<td>193260.956591</td>
<td>656.855964</td>
<td>611.463015</td>
<td>53182.233431</td>
<td>514.898513</td>
<td>475.288902</td>
<td>856.364728</td>
<td>3.168872</td>
<td>2.914506</td>
<td>0.39357</td>
<td>5453.474130</td>
<td>22.399457</td>
<td>26308.573419</td>
<td>149.807859</td>
<td>842.146810</td>
<td>12.298781</td>
<td>24168.937379</td>
<td>98.726733</td>
<td>5.613885e+05</td>
<td>1.801855e+08</td>
<td>1131.024910</td>
<td>4.573386</td>
<td>5.000443e+05</td>
<td>3.982051</td>
<td>0.063095</td>
<td>96.826696</td>
<td>2.828810e+08</td>
<td>1.715422e+08</td>
<td>1.136508e+08</td>
<td>2.068579e+07</td>
<td>1.653290e+06</td>
<td>1.453322e+06</td>
<td>65.615643</td>
<td>28.826050</td>
<td>28.475631</td>
<td>18.788789</td>
<td>3093.759435</td>
<td>8.317038e+05</td>
<td>0.181709</td>
<td>17.688749</td>
<td>3.887761e+08</td>
<td>171.340671</td>
<td>6.045539</td>
<td>6.145592</td>
<td>4.649445</td>
<td>13596.356671</td>
<td>7.104167</td>
<td>104.592235</td>
<td>2.204401</td>
<td>8.869313</td>
<td>11.113599</td>
<td>4.550445e-13</td>
<td>4.150498</td>
<td>4.790136</td>
<td>0.090695</td>
<td>2.181352e+05</td>
<td>7.737350</td>
<td>16.272627</td>
<td>1006.519309</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>1.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.001000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.001000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.19000</td>
<td>8.000000</td>
<td>0.156000</td>
<td>127.000000</td>
<td>2.104000</td>
<td>34.000000</td>
<td>0.563000</td>
<td>24.000000</td>
<td>0.286000</td>
<td>4.000000e+00</td>
<td>4.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>9.000000e+00</td>
<td>0.000000</td>
<td>0.000500</td>
<td>2.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>1.000000e+00</td>
<td>1.000000e+00</td>
<td>0.000000e+00</td>
<td>4.440000e+02</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>4.000000</td>
<td>2.390000e+02</td>
<td>0.000000</td>
<td>0.000000</td>
<td>5.130518e+07</td>
<td>8.823000</td>
<td>28.200000</td>
<td>5.989000</td>
<td>3.414000</td>
<td>6426.674000</td>
<td>0.100000</td>
<td>79.370000</td>
<td>4.280000</td>
<td>1.900000</td>
<td>17.900000</td>
<td>5.955000e+01</td>
<td>0.530000</td>
<td>69.660000</td>
<td>0.645000</td>
<td>-3.772610e+04</td>
<td>-9.020000</td>
<td>-19.200000</td>
<td>-299.292834</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>2.297820e+05</td>
<td>1.333000e+03</td>
<td>1440.107250</td>
<td>10145.000000</td>
<td>23.000000</td>
<td>27.857000</td>
<td>2831.535000</td>
<td>12.022000</td>
<td>12.578000</td>
<td>98.069000</td>
<td>0.214000</td>
<td>0.242000</td>
<td>0.90000</td>
<td>348.000000</td>
<td>5.410000</td>
<td>6009.000000</td>
<td>78.055000</td>
<td>323.000000</td>
<td>4.903000</td>
<td>1932.500000</td>
<td>28.734000</td>
<td>6.352250e+04</td>
<td>8.584362e+06</td>
<td>75.098750</td>
<td>0.529000</td>
<td>6.720050e+04</td>
<td>0.548000</td>
<td>0.016375</td>
<td>14.300000</td>
<td>2.813928e+07</td>
<td>2.034653e+07</td>
<td>8.608600e+06</td>
<td>1.092000e+04</td>
<td>1.893440e+05</td>
<td>2.088040e+05</td>
<td>22.652500</td>
<td>15.930000</td>
<td>6.700000</td>
<td>0.012500</td>
<td>1946.000000</td>
<td>4.624100e+04</td>
<td>0.050000</td>
<td>47.690000</td>
<td>6.742200e+07</td>
<td>35.608000</td>
<td>38.300000</td>
<td>13.914000</td>
<td>8.622000</td>
<td>24765.954000</td>
<td>0.200000</td>
<td>86.060000</td>
<td>4.780000</td>
<td>10.100000</td>
<td>24.600000</td>
<td>5.955000e+01</td>
<td>2.540000</td>
<td>75.880000</td>
<td>0.824000</td>
<td>-1.335500e+02</td>
<td>-0.052500</td>
<td>-0.252500</td>
<td>-2.603051</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>2.702681e+06</td>
<td>9.921000e+03</td>
<td>11149.928500</td>
<td>83976.000000</td>
<td>161.000000</td>
<td>177.714000</td>
<td>17491.567000</td>
<td>62.362000</td>
<td>67.154500</td>
<td>554.520000</td>
<td>0.977000</td>
<td>1.106000</td>
<td>1.03000</td>
<td>1134.000000</td>
<td>15.918000</td>
<td>14665.000000</td>
<td>138.495000</td>
<td>927.000000</td>
<td>13.779000</td>
<td>6417.000000</td>
<td>84.415000</td>
<td>2.430530e+05</td>
<td>4.054337e+07</td>
<td>285.623500</td>
<td>1.642000</td>
<td>2.152790e+05</td>
<td>1.811500</td>
<td>0.040500</td>
<td>24.700000</td>
<td>9.093913e+07</td>
<td>4.748998e+07</td>
<td>4.155760e+07</td>
<td>3.335546e+06</td>
<td>4.347705e+05</td>
<td>4.510670e+05</td>
<td>87.745000</td>
<td>52.570000</td>
<td>36.935000</td>
<td>2.520000</td>
<td>3696.000000</td>
<td>1.679190e+05</td>
<td>0.112000</td>
<td>60.650000</td>
<td>8.390047e+07</td>
<td>237.016000</td>
<td>42.000000</td>
<td>18.517000</td>
<td>12.527000</td>
<td>38605.671000</td>
<td>1.200000</td>
<td>122.137000</td>
<td>6.180000</td>
<td>19.800000</td>
<td>33.100000</td>
<td>5.955000e+01</td>
<td>5.980000</td>
<td>81.330000</td>
<td>0.916000</td>
<td>5.249990e+04</td>
<td>6.900000</td>
<td>5.745000</td>
<td>707.315534</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>7.906961e+06</td>
<td>3.357100e+04</td>
<td>35266.357250</td>
<td>149512.000000</td>
<td>535.500000</td>
<td>567.143000</td>
<td>64999.770000</td>
<td>209.744000</td>
<td>216.940500</td>
<td>1631.352000</td>
<td>3.464500</td>
<td>3.727000</td>
<td>1.22000</td>
<td>3489.750000</td>
<td>39.497000</td>
<td>28951.000000</td>
<td>307.959000</td>
<td>1584.000000</td>
<td>21.595000</td>
<td>12810.000000</td>
<td>144.512000</td>
<td>7.657615e+05</td>
<td>1.513048e+08</td>
<td>1030.061250</td>
<td>4.201500</td>
<td>5.807640e+05</td>
<td>3.735250</td>
<td>0.069800</td>
<td>61.050000</td>
<td>1.591653e+08</td>
<td>8.801805e+07</td>
<td>6.110446e+07</td>
<td>2.359063e+07</td>
<td>9.227180e+05</td>
<td>8.611230e+05</td>
<td>140.575000</td>
<td>73.237500</td>
<td>64.760000</td>
<td>22.517500</td>
<td>6395.000000</td>
<td>3.894540e+05</td>
<td>0.261000</td>
<td>71.760000</td>
<td>2.139934e+08</td>
<td>347.778000</td>
<td>46.600000</td>
<td>21.453000</td>
<td>15.957000</td>
<td>39753.244000</td>
<td>3.400000</td>
<td>177.961000</td>
<td>8.310000</td>
<td>23.400000</td>
<td>35.600000</td>
<td>5.955000e+01</td>
<td>8.050000</td>
<td>83.030000</td>
<td>0.926000</td>
<td>1.191370e+05</td>
<td>13.530000</td>
<td>14.987500</td>
<td>1517.147097</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>7.926573e+07</td>
<td>1.368167e+06</td>
<td>802518.429000</td>
<td>958437.000000</td>
<td>4529.000000</td>
<td>4190.000000</td>
<td>342095.547000</td>
<td>7453.161000</td>
<td>5436.723000</td>
<td>3047.832000</td>
<td>26.683000</td>
<td>18.308000</td>
<td>6.14000</td>
<td>28891.000000</td>
<td>104.105000</td>
<td>154536.000000</td>
<td>637.877000</td>
<td>4838.000000</td>
<td>71.757000</td>
<td>154696.000000</td>
<td>839.129000</td>
<td>3.740296e+06</td>
<td>8.206194e+08</td>
<td>6842.977000</td>
<td>32.956000</td>
<td>3.080396e+06</td>
<td>27.372000</td>
<td>0.491300</td>
<td>1867.100000</td>
<td>1.786849e+09</td>
<td>9.671539e+08</td>
<td>8.003048e+08</td>
<td>9.492562e+07</td>
<td>1.862727e+07</td>
<td>1.003800e+07</td>
<td>232.900000</td>
<td>87.460000</td>
<td>86.520000</td>
<td>62.670000</td>
<td>17164.000000</td>
<td>6.785334e+06</td>
<td>1.183000</td>
<td>100.000000</td>
<td>1.393409e+09</td>
<td>527.967000</td>
<td>48.200000</td>
<td>27.049000</td>
<td>18.493000</td>
<td>54225.446000</td>
<td>21.200000</td>
<td>431.297000</td>
<td>10.790000</td>
<td>30.100000</td>
<td>58.300000</td>
<td>5.955000e+01</td>
<td>13.050000</td>
<td>84.630000</td>
<td>0.947000</td>
<td>1.080748e+06</td>
<td>30.850000</td>
<td>107.250000</td>
<td>7406.847532</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Uma outra coisa que pode ser bastante interessante é saber quantas vezes os valores de determinada variável se repetem. Quantas vezes cada país da base de dados aparece no DataFrame?</p>
<div id="89d19db6" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_covid[<span class="st">'location'</span>].value_counts()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>location
Japan             774
South Korea       774
United States     774
France            772
Germany           769
India             766
Italy             765
Russia            765
United Kingdom    765
Brazil            739
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="66e9c057" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_covid[<span class="st">'location'</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>,dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>location
Japan             0.101005
South Korea       0.101005
United States     0.101005
France            0.100744
Germany           0.100352
India             0.099961
Italy             0.099830
Russia            0.099830
United Kingdom    0.099830
Brazil            0.096437
Name: proportion, dtype: float64</code></pre>
</div>
</div>
<p>Por fim, podemos ordenar o DataFrame de acordo com uma coluna ou um conjunto de colunas. Qual eram os países com o maior número de novos casos de covid reportados no dia 1 de março de 2022?</p>
<div id="1b12fa07" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_covid[df_covid[<span class="st">'date'</span>]<span class="op">==</span><span class="st">'2022-03-01'</span>].sort_values(by<span class="op">=</span>[<span class="st">'new_cases'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">total_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">total_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">reproduction_rate</th>
<th data-quarto-table-cell-role="th">icu_patients</th>
<th data-quarto-table-cell-role="th">icu_patients_per_million</th>
<th data-quarto-table-cell-role="th">hosp_patients</th>
<th data-quarto-table-cell-role="th">hosp_patients_per_million</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions_per_million</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions_per_million</th>
<th data-quarto-table-cell-role="th">new_tests</th>
<th data-quarto-table-cell-role="th">total_tests</th>
<th data-quarto-table-cell-role="th">total_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed_per_thousand</th>
<th data-quarto-table-cell-role="th">positive_rate</th>
<th data-quarto-table-cell-role="th">tests_per_case</th>
<th data-quarto-table-cell-role="th">tests_units</th>
<th data-quarto-table-cell-role="th">total_vaccinations</th>
<th data-quarto-table-cell-role="th">people_vaccinated</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated</th>
<th data-quarto-table-cell-role="th">total_boosters</th>
<th data-quarto-table-cell-role="th">new_vaccinations</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed</th>
<th data-quarto-table-cell-role="th">total_vaccinations_per_hundred</th>
<th data-quarto-table-cell-role="th">people_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">total_boosters_per_hundred</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed_per_hundred</th>
<th data-quarto-table-cell-role="th">stringency_index</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">population_density</th>
<th data-quarto-table-cell-role="th">median_age</th>
<th data-quarto-table-cell-role="th">aged_65_older</th>
<th data-quarto-table-cell-role="th">aged_70_older</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">extreme_poverty</th>
<th data-quarto-table-cell-role="th">cardiovasc_death_rate</th>
<th data-quarto-table-cell-role="th">diabetes_prevalence</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">6119</th>
<td>KOR</td>
<td>Asia</td>
<td>South Korea</td>
<td>2022-03-01</td>
<td>3492686.0</td>
<td>219237.0</td>
<td>166214.857</td>
<td>8266.0</td>
<td>96.0</td>
<td>94.143</td>
<td>68076.668</td>
<td>4273.194</td>
<td>3239.728</td>
<td>161.114</td>
<td>1.871</td>
<td>1.835</td>
<td>1.34</td>
<td>727.0</td>
<td>14.170</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>12606.0</td>
<td>245.706</td>
<td>717980.0</td>
<td>62135661.0</td>
<td>1211.099</td>
<td>13.994</td>
<td>511822.0</td>
<td>9.976</td>
<td>0.3248</td>
<td>3.1</td>
<td>people tested</td>
<td>1.192321e+08</td>
<td>44862508.0</td>
<td>44372141.0</td>
<td>31512659.0</td>
<td>5367.0</td>
<td>119659.0</td>
<td>232.40</td>
<td>87.44</td>
<td>86.49</td>
<td>61.42</td>
<td>2332.0</td>
<td>4582.0</td>
<td>0.009</td>
<td>40.74</td>
<td>5.130518e+07</td>
<td>527.967</td>
<td>43.4</td>
<td>13.914</td>
<td>8.622</td>
<td>35938.374</td>
<td>0.2</td>
<td>85.998</td>
<td>6.80</td>
<td>6.2</td>
<td>40.9</td>
<td>NaN</td>
<td>12.27</td>
<td>83.03</td>
<td>0.916</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">6884</th>
<td>GBR</td>
<td>Europe</td>
<td>United Kingdom</td>
<td>2022-03-01</td>
<td>19036570.0</td>
<td>99485.0</td>
<td>41712.714</td>
<td>161773.0</td>
<td>269.0</td>
<td>116.857</td>
<td>279099.479</td>
<td>1458.572</td>
<td>611.560</td>
<td>2371.791</td>
<td>3.944</td>
<td>1.713</td>
<td>1.05</td>
<td>278.0</td>
<td>4.076</td>
<td>10776.0</td>
<td>157.989</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>673040.0</td>
<td>465243695.0</td>
<td>6821.044</td>
<td>9.868</td>
<td>653726.0</td>
<td>9.584</td>
<td>0.0638</td>
<td>15.7</td>
<td>tests performed</td>
<td>1.399278e+08</td>
<td>52640258.0</td>
<td>49029528.0</td>
<td>38258018.0</td>
<td>43493.0</td>
<td>48021.0</td>
<td>205.15</td>
<td>77.18</td>
<td>71.88</td>
<td>56.09</td>
<td>704.0</td>
<td>7281.0</td>
<td>0.011</td>
<td>NaN</td>
<td>6.820711e+07</td>
<td>272.898</td>
<td>40.8</td>
<td>18.517</td>
<td>12.527</td>
<td>39753.244</td>
<td>0.2</td>
<td>122.137</td>
<td>4.28</td>
<td>20.0</td>
<td>24.7</td>
<td>NaN</td>
<td>2.54</td>
<td>81.32</td>
<td>0.932</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5345</th>
<td>RUS</td>
<td>Europe</td>
<td>Russia</td>
<td>2022-03-01</td>
<td>16257688.0</td>
<td>96092.0</td>
<td>118164.000</td>
<td>345427.0</td>
<td>772.0</td>
<td>760.857</td>
<td>111421.169</td>
<td>658.561</td>
<td>809.830</td>
<td>2367.365</td>
<td>5.291</td>
<td>5.214</td>
<td>0.78</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>81119.0</td>
<td>555.945</td>
<td>272654.0</td>
<td>276734652.0</td>
<td>1896.586</td>
<td>1.869</td>
<td>414545.0</td>
<td>2.841</td>
<td>0.2850</td>
<td>3.5</td>
<td>tests performed</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7425.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>51.0</td>
<td>27479.0</td>
<td>0.019</td>
<td>NaN</td>
<td>1.459120e+08</td>
<td>8.823</td>
<td>39.6</td>
<td>14.178</td>
<td>9.393</td>
<td>24765.954</td>
<td>0.1</td>
<td>431.297</td>
<td>6.18</td>
<td>23.4</td>
<td>58.3</td>
<td>NaN</td>
<td>8.05</td>
<td>72.58</td>
<td>0.824</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1506</th>
<td>FRA</td>
<td>Europe</td>
<td>France</td>
<td>2022-03-01</td>
<td>22835320.0</td>
<td>79794.0</td>
<td>54468.000</td>
<td>138645.0</td>
<td>209.0</td>
<td>185.714</td>
<td>338692.415</td>
<td>1183.501</td>
<td>807.867</td>
<td>2056.376</td>
<td>3.100</td>
<td>2.755</td>
<td>0.67</td>
<td>2408.0</td>
<td>35.715</td>
<td>24437.0</td>
<td>362.448</td>
<td>940.0</td>
<td>13.942</td>
<td>7865.0</td>
<td>116.653</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.408727e+08</td>
<td>53961132.0</td>
<td>52317204.0</td>
<td>35672010.0</td>
<td>53652.0</td>
<td>63196.0</td>
<td>208.94</td>
<td>80.03</td>
<td>77.60</td>
<td>52.91</td>
<td>937.0</td>
<td>3135.0</td>
<td>0.005</td>
<td>NaN</td>
<td>6.742200e+07</td>
<td>122.578</td>
<td>42.0</td>
<td>19.718</td>
<td>13.079</td>
<td>38605.671</td>
<td>NaN</td>
<td>86.060</td>
<td>4.77</td>
<td>30.1</td>
<td>35.6</td>
<td>NaN</td>
<td>5.98</td>
<td>82.66</td>
<td>0.901</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4580</th>
<td>JPN</td>
<td>Asia</td>
<td>Japan</td>
<td>2022-03-01</td>
<td>5071249.0</td>
<td>65368.0</td>
<td>65592.143</td>
<td>23905.0</td>
<td>238.0</td>
<td>223.714</td>
<td>40231.789</td>
<td>518.585</td>
<td>520.363</td>
<td>189.646</td>
<td>1.888</td>
<td>1.775</td>
<td>0.97</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>168484.0</td>
<td>37629310.0</td>
<td>298.525</td>
<td>1.337</td>
<td>161137.0</td>
<td>1.278</td>
<td>0.4071</td>
<td>2.5</td>
<td>people tested</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>985076.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7815.0</td>
<td>12819.0</td>
<td>0.010</td>
<td>NaN</td>
<td>1.260508e+08</td>
<td>347.778</td>
<td>48.2</td>
<td>27.049</td>
<td>18.493</td>
<td>39002.223</td>
<td>NaN</td>
<td>79.370</td>
<td>5.72</td>
<td>11.2</td>
<td>33.7</td>
<td>NaN</td>
<td>13.05</td>
<td>84.63</td>
<td>0.919</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2275</th>
<td>DEU</td>
<td>Europe</td>
<td>Germany</td>
<td>2022-03-01</td>
<td>14974722.0</td>
<td>62096.0</td>
<td>135435.286</td>
<td>123024.0</td>
<td>75.0</td>
<td>159.429</td>
<td>178481.978</td>
<td>740.115</td>
<td>1614.237</td>
<td>1466.309</td>
<td>0.894</td>
<td>1.900</td>
<td>0.82</td>
<td>2288.0</td>
<td>27.270</td>
<td>NaN</td>
<td>NaN</td>
<td>1525.0</td>
<td>18.176</td>
<td>7443.0</td>
<td>88.712</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.700861e+08</td>
<td>63472773.0</td>
<td>62753256.0</td>
<td>47462955.0</td>
<td>110964.0</td>
<td>100482.0</td>
<td>202.72</td>
<td>75.65</td>
<td>74.79</td>
<td>56.57</td>
<td>1198.0</td>
<td>8140.0</td>
<td>0.010</td>
<td>73.15</td>
<td>8.390047e+07</td>
<td>237.016</td>
<td>46.6</td>
<td>21.453</td>
<td>15.957</td>
<td>45229.245</td>
<td>NaN</td>
<td>156.139</td>
<td>8.31</td>
<td>28.2</td>
<td>33.1</td>
<td>NaN</td>
<td>8.00</td>
<td>81.33</td>
<td>0.947</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3806</th>
<td>ITA</td>
<td>Europe</td>
<td>Italy</td>
<td>2022-03-01</td>
<td>12829972.0</td>
<td>47136.0</td>
<td>39339.429</td>
<td>155000.0</td>
<td>233.0</td>
<td>212.571</td>
<td>212531.216</td>
<td>780.818</td>
<td>651.666</td>
<td>2567.608</td>
<td>3.860</td>
<td>3.521</td>
<td>0.76</td>
<td>708.0</td>
<td>11.728</td>
<td>11164.0</td>
<td>184.934</td>
<td>378.0</td>
<td>6.262</td>
<td>NaN</td>
<td>NaN</td>
<td>530858.0</td>
<td>187867237.0</td>
<td>3112.061</td>
<td>8.794</td>
<td>412189.0</td>
<td>6.828</td>
<td>0.0954</td>
<td>10.5</td>
<td>tests performed</td>
<td>1.342220e+08</td>
<td>50627970.0</td>
<td>47502445.0</td>
<td>37598486.0</td>
<td>84125.0</td>
<td>108220.0</td>
<td>222.34</td>
<td>83.87</td>
<td>78.69</td>
<td>62.28</td>
<td>1793.0</td>
<td>5584.0</td>
<td>0.009</td>
<td>63.89</td>
<td>6.036747e+07</td>
<td>205.859</td>
<td>47.9</td>
<td>23.021</td>
<td>16.240</td>
<td>35220.084</td>
<td>2.0</td>
<td>113.151</td>
<td>4.78</td>
<td>19.8</td>
<td>27.8</td>
<td>NaN</td>
<td>3.18</td>
<td>83.51</td>
<td>0.892</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7658</th>
<td>USA</td>
<td>North America</td>
<td>United States</td>
<td>2022-03-01</td>
<td>79091361.0</td>
<td>47031.0</td>
<td>62331.429</td>
<td>952423.0</td>
<td>1691.0</td>
<td>1830.000</td>
<td>237572.183</td>
<td>141.270</td>
<td>187.229</td>
<td>2860.859</td>
<td>5.079</td>
<td>5.497</td>
<td>0.59</td>
<td>7314.0</td>
<td>21.970</td>
<td>36214.0</td>
<td>108.778</td>
<td>NaN</td>
<td>NaN</td>
<td>32132.0</td>
<td>96.517</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.544755e+08</td>
<td>253899142.0</td>
<td>215166280.0</td>
<td>94753028.0</td>
<td>241635.0</td>
<td>264689.0</td>
<td>167.01</td>
<td>76.47</td>
<td>64.81</td>
<td>28.54</td>
<td>797.0</td>
<td>69472.0</td>
<td>0.021</td>
<td>NaN</td>
<td>3.329151e+08</td>
<td>35.608</td>
<td>38.3</td>
<td>15.413</td>
<td>9.732</td>
<td>54225.446</td>
<td>1.2</td>
<td>151.089</td>
<td>10.79</td>
<td>19.1</td>
<td>24.6</td>
<td>NaN</td>
<td>2.77</td>
<td>78.86</td>
<td>0.926</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-01</td>
<td>28818850.0</td>
<td>22279.0</td>
<td>65271.286</td>
<td>649922.0</td>
<td>246.0</td>
<td>598.143</td>
<td>134671.651</td>
<td>104.111</td>
<td>305.015</td>
<td>3037.112</td>
<td>1.150</td>
<td>2.795</td>
<td>0.48</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>19430.0</td>
<td>0.091</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>3.929256e+08</td>
<td>177836868.0</td>
<td>155071690.0</td>
<td>65073212.0</td>
<td>161992.0</td>
<td>814209.0</td>
<td>183.62</td>
<td>83.10</td>
<td>72.47</td>
<td>30.41</td>
<td>3805.0</td>
<td>173043.0</td>
<td>0.081</td>
<td>NaN</td>
<td>2.139934e+08</td>
<td>25.040</td>
<td>33.5</td>
<td>8.552</td>
<td>5.060</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.20</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3041</th>
<td>IND</td>
<td>Asia</td>
<td>India</td>
<td>2022-03-01</td>
<td>42938599.0</td>
<td>7554.0</td>
<td>10224.000</td>
<td>514246.0</td>
<td>223.0</td>
<td>232.000</td>
<td>30815.502</td>
<td>5.421</td>
<td>7.337</td>
<td>369.056</td>
<td>0.160</td>
<td>0.166</td>
<td>0.35</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>901647.0</td>
<td>768382993.0</td>
<td>551.441</td>
<td>0.647</td>
<td>1021773.0</td>
<td>0.733</td>
<td>0.0100</td>
<td>99.9</td>
<td>samples tested</td>
<td>1.776674e+09</td>
<td>965923463.0</td>
<td>791803734.0</td>
<td>18947182.0</td>
<td>1495732.0</td>
<td>2450184.0</td>
<td>127.51</td>
<td>69.32</td>
<td>56.82</td>
<td>1.36</td>
<td>1758.0</td>
<td>343712.0</td>
<td>0.025</td>
<td>NaN</td>
<td>1.393409e+09</td>
<td>450.419</td>
<td>28.2</td>
<td>5.989</td>
<td>3.414</td>
<td>6426.674</td>
<td>21.2</td>
<td>282.280</td>
<td>10.39</td>
<td>1.9</td>
<td>20.6</td>
<td>59.55</td>
<td>0.53</td>
<td>69.66</td>
<td>0.645</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note que no código acima utilizamos uma forma de filtragem dos dados com base em uma condição, que é a data ser igual a 01 de março de 2022. Vamos ir com calma e mostrar todos os passos para realizar indexação, seleção e filtragem em dataframes agora.</p>
</section>
<section id="indexação-seleção-e-filtragem" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="indexação-seleção-e-filtragem"><span class="header-section-number">8.3.3</span> Indexação, seleção e filtragem</h3>
<p>Podemos selecionar um intervalo particular de linhas do DataFrame usando a lógica de indexação de sempre.</p>
<div id="693acdd9" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_covid[<span class="dv">0</span>:<span class="dv">2</span>]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">total_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">total_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">reproduction_rate</th>
<th data-quarto-table-cell-role="th">icu_patients</th>
<th data-quarto-table-cell-role="th">icu_patients_per_million</th>
<th data-quarto-table-cell-role="th">hosp_patients</th>
<th data-quarto-table-cell-role="th">hosp_patients_per_million</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions_per_million</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions_per_million</th>
<th data-quarto-table-cell-role="th">new_tests</th>
<th data-quarto-table-cell-role="th">total_tests</th>
<th data-quarto-table-cell-role="th">total_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed_per_thousand</th>
<th data-quarto-table-cell-role="th">positive_rate</th>
<th data-quarto-table-cell-role="th">tests_per_case</th>
<th data-quarto-table-cell-role="th">tests_units</th>
<th data-quarto-table-cell-role="th">total_vaccinations</th>
<th data-quarto-table-cell-role="th">people_vaccinated</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated</th>
<th data-quarto-table-cell-role="th">total_boosters</th>
<th data-quarto-table-cell-role="th">new_vaccinations</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed</th>
<th data-quarto-table-cell-role="th">total_vaccinations_per_hundred</th>
<th data-quarto-table-cell-role="th">people_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">total_boosters_per_hundred</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed_per_hundred</th>
<th data-quarto-table-cell-role="th">stringency_index</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">population_density</th>
<th data-quarto-table-cell-role="th">median_age</th>
<th data-quarto-table-cell-role="th">aged_65_older</th>
<th data-quarto-table-cell-role="th">aged_70_older</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">extreme_poverty</th>
<th data-quarto-table-cell-role="th">cardiovasc_death_rate</th>
<th data-quarto-table-cell-role="th">diabetes_prevalence</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.005</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Utilizando a função <code>.iloc</code> podemos selecionar linhas e colunas com os índices numéricos. E se quisermos, por exemplo, comparar o número total de casos de todos os países ao longo do tempo, mantendo apenas as variáveis <code>location</code>, <code>date</code> e <code>total_cases</code>?</p>
<div id="009aba8a" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df_covid.iloc[:,<span class="dv">2</span>:<span class="dv">5</span>]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Brazil</td>
<td>2020-02-28</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Brazil</td>
<td>2020-02-29</td>
<td>2.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Brazil</td>
<td>2020-03-01</td>
<td>2.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7658</th>
<td>United States</td>
<td>2022-03-01</td>
<td>79091361.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7659</th>
<td>United States</td>
<td>2022-03-02</td>
<td>79143716.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7660</th>
<td>United States</td>
<td>2022-03-03</td>
<td>79196008.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7661</th>
<td>United States</td>
<td>2022-03-04</td>
<td>79250509.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7662</th>
<td>United States</td>
<td>2022-03-05</td>
<td>79265726.0</td>
</tr>
</tbody>
</table>

<p>7663 rows × 3 columns</p>
</div>
</div>
</div>
<p>Podemos fazer exatamente a mesma coisa com a função <code>.loc</code> e utilizando uma mistura de índices numéricos para as linhas e seleção das colunas através de seus nomes.</p>
<div id="79050784" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_covid.loc[:, [<span class="st">'location'</span>,<span class="st">'date'</span>,<span class="st">'total_cases'</span>]]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Brazil</td>
<td>2020-02-28</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Brazil</td>
<td>2020-02-29</td>
<td>2.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Brazil</td>
<td>2020-03-01</td>
<td>2.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7658</th>
<td>United States</td>
<td>2022-03-01</td>
<td>79091361.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7659</th>
<td>United States</td>
<td>2022-03-02</td>
<td>79143716.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7660</th>
<td>United States</td>
<td>2022-03-03</td>
<td>79196008.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7661</th>
<td>United States</td>
<td>2022-03-04</td>
<td>79250509.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7662</th>
<td>United States</td>
<td>2022-03-05</td>
<td>79265726.0</td>
</tr>
</tbody>
</table>

<p>7663 rows × 3 columns</p>
</div>
</div>
</div>
<p>Uma terceira forma de fazer esse exercício de seleção de uma parte de um DataFrame já criado é através da criação de um novo DataFrame que mantenha apenas as colunas <code>location</code>, <code>date</code> e <code>total_cases</code>.</p>
<div id="d30c69f3" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>columns_to_keep <span class="op">=</span> [<span class="st">'location'</span>,<span class="st">'date'</span>,<span class="st">'total_cases'</span>]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df_covid2 <span class="op">=</span> df_covid[columns_to_keep]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>df_covid2.head(<span class="dv">2</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Podemos inclusive alterar o nome das colunas desse novo DataFrame de forma bem direta.</p>
<div id="65199528" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_covid2.columns <span class="op">=</span> [<span class="st">'localizacao'</span>,<span class="st">'data'</span>,<span class="st">'casos'</span>]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df_covid2.head()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">localizacao</th>
<th data-quarto-table-cell-role="th">data</th>
<th data-quarto-table-cell-role="th">casos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Brazil</td>
<td>2020-02-28</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Brazil</td>
<td>2020-02-29</td>
<td>2.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Brazil</td>
<td>2020-03-01</td>
<td>2.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>É possível redefinir o índice desse novo DataFrame para ser igual ao país.</p>
<div id="4993835d" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_covid2.set_index(<span class="st">'localizacao'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_covid2.head(<span class="dv">2</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">data</th>
<th data-quarto-table-cell-role="th">casos</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">localizacao</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Brazil</th>
<td>2020-02-26</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Brazil</th>
<td>2020-02-27</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Por fim, podemos selecionar parte específica de um DataFrame utilizando testes booleanos sobre valores de linhas e colunas.</p>
<ul>
<li>Selecionar apenas os dados brasileiros</li>
</ul>
<div id="43b34517" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_covid[df_covid[<span class="st">'location'</span>]<span class="op">==</span><span class="st">'Brazil'</span>]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">total_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">total_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">reproduction_rate</th>
<th data-quarto-table-cell-role="th">icu_patients</th>
<th data-quarto-table-cell-role="th">icu_patients_per_million</th>
<th data-quarto-table-cell-role="th">hosp_patients</th>
<th data-quarto-table-cell-role="th">hosp_patients_per_million</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions_per_million</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions_per_million</th>
<th data-quarto-table-cell-role="th">new_tests</th>
<th data-quarto-table-cell-role="th">total_tests</th>
<th data-quarto-table-cell-role="th">total_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed_per_thousand</th>
<th data-quarto-table-cell-role="th">positive_rate</th>
<th data-quarto-table-cell-role="th">tests_per_case</th>
<th data-quarto-table-cell-role="th">tests_units</th>
<th data-quarto-table-cell-role="th">total_vaccinations</th>
<th data-quarto-table-cell-role="th">people_vaccinated</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated</th>
<th data-quarto-table-cell-role="th">total_boosters</th>
<th data-quarto-table-cell-role="th">new_vaccinations</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed</th>
<th data-quarto-table-cell-role="th">total_vaccinations_per_hundred</th>
<th data-quarto-table-cell-role="th">people_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">total_boosters_per_hundred</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed_per_hundred</th>
<th data-quarto-table-cell-role="th">stringency_index</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">population_density</th>
<th data-quarto-table-cell-role="th">median_age</th>
<th data-quarto-table-cell-role="th">aged_65_older</th>
<th data-quarto-table-cell-role="th">aged_70_older</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">extreme_poverty</th>
<th data-quarto-table-cell-role="th">cardiovasc_death_rate</th>
<th data-quarto-table-cell-role="th">diabetes_prevalence</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.005</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-28</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-29</td>
<td>2.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.009</td>
<td>0.005</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>7049.6</td>
<td>3.31</td>
<td>5.25</td>
<td>32.943066</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-03-01</td>
<td>2.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.009</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-01</td>
<td>28818850.0</td>
<td>22279.0</td>
<td>65271.286</td>
<td>649922.0</td>
<td>246.0</td>
<td>598.143</td>
<td>134671.651</td>
<td>104.111</td>
<td>305.015</td>
<td>3037.112</td>
<td>1.150</td>
<td>2.795</td>
<td>0.48</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>19430.0</td>
<td>0.091</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>392925626.0</td>
<td>177836868.0</td>
<td>155071690.0</td>
<td>65073212.0</td>
<td>161992.0</td>
<td>814209.0</td>
<td>183.62</td>
<td>83.10</td>
<td>72.47</td>
<td>30.41</td>
<td>3805.0</td>
<td>173043.0</td>
<td>0.081</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-02</td>
<td>28846495.0</td>
<td>27645.0</td>
<td>50451.286</td>
<td>650254.0</td>
<td>332.0</td>
<td>505.714</td>
<td>134800.837</td>
<td>129.186</td>
<td>235.761</td>
<td>3038.663</td>
<td>1.551</td>
<td>2.363</td>
<td>0.45</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>19430.0</td>
<td>0.091</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>744548.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3479.0</td>
<td>141712.0</td>
<td>0.066</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-03</td>
<td>28906672.0</td>
<td>60177.0</td>
<td>45348.143</td>
<td>650824.0</td>
<td>570.0</td>
<td>445.857</td>
<td>135082.047</td>
<td>281.210</td>
<td>211.914</td>
<td>3041.327</td>
<td>2.664</td>
<td>2.084</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>69951873.0</td>
<td>326.888</td>
<td>NaN</td>
<td>19430.0</td>
<td>0.091</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>394111796.0</td>
<td>177987744.0</td>
<td>155380086.0</td>
<td>65802661.0</td>
<td>NaN</td>
<td>623346.0</td>
<td>184.17</td>
<td>83.17</td>
<td>72.61</td>
<td>30.75</td>
<td>2913.0</td>
<td>116179.0</td>
<td>0.054</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-04</td>
<td>28978052.0</td>
<td>71380.0</td>
<td>42625.857</td>
<td>651522.0</td>
<td>698.0</td>
<td>432.286</td>
<td>135415.608</td>
<td>333.562</td>
<td>199.192</td>
<td>3044.589</td>
<td>3.262</td>
<td>2.020</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>394812859.0</td>
<td>178113009.0</td>
<td>155569412.0</td>
<td>66190014.0</td>
<td>701063.0</td>
<td>508531.0</td>
<td>184.50</td>
<td>83.23</td>
<td>72.70</td>
<td>30.93</td>
<td>2376.0</td>
<td>94869.0</td>
<td>0.044</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-05</td>
<td>29040800.0</td>
<td>62748.0</td>
<td>41606.857</td>
<td>652216.0</td>
<td>694.0</td>
<td>433.143</td>
<td>135708.832</td>
<td>293.224</td>
<td>194.431</td>
<td>3047.832</td>
<td>3.243</td>
<td>2.024</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>395464826.0</td>
<td>178203894.0</td>
<td>155711613.0</td>
<td>66609966.0</td>
<td>651967.0</td>
<td>525686.0</td>
<td>184.80</td>
<td>83.28</td>
<td>72.76</td>
<td>31.13</td>
<td>2457.0</td>
<td>94157.0</td>
<td>0.044</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>739 rows × 67 columns</p>
</div>
</div>
</div>
<ul>
<li>Selecionar os dados brasileiros e apenas à partir do momento em que o número de casos se tornou maior do que 10 milhões</li>
</ul>
<div id="527d4338" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_covid[(df_covid[<span class="st">'location'</span>]<span class="op">==</span><span class="st">'Brazil'</span>) <span class="op">&amp;</span> (df_covid[<span class="st">'total_cases'</span>]<span class="op">&gt;=</span><span class="dv">10000000</span>)]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">total_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">total_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">reproduction_rate</th>
<th data-quarto-table-cell-role="th">icu_patients</th>
<th data-quarto-table-cell-role="th">icu_patients_per_million</th>
<th data-quarto-table-cell-role="th">hosp_patients</th>
<th data-quarto-table-cell-role="th">hosp_patients_per_million</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions_per_million</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions_per_million</th>
<th data-quarto-table-cell-role="th">new_tests</th>
<th data-quarto-table-cell-role="th">total_tests</th>
<th data-quarto-table-cell-role="th">total_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed_per_thousand</th>
<th data-quarto-table-cell-role="th">positive_rate</th>
<th data-quarto-table-cell-role="th">tests_per_case</th>
<th data-quarto-table-cell-role="th">tests_units</th>
<th data-quarto-table-cell-role="th">total_vaccinations</th>
<th data-quarto-table-cell-role="th">people_vaccinated</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated</th>
<th data-quarto-table-cell-role="th">total_boosters</th>
<th data-quarto-table-cell-role="th">new_vaccinations</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed</th>
<th data-quarto-table-cell-role="th">total_vaccinations_per_hundred</th>
<th data-quarto-table-cell-role="th">people_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">total_boosters_per_hundred</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed_per_hundred</th>
<th data-quarto-table-cell-role="th">stringency_index</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">population_density</th>
<th data-quarto-table-cell-role="th">median_age</th>
<th data-quarto-table-cell-role="th">aged_65_older</th>
<th data-quarto-table-cell-role="th">aged_70_older</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">extreme_poverty</th>
<th data-quarto-table-cell-role="th">cardiovasc_death_rate</th>
<th data-quarto-table-cell-role="th">diabetes_prevalence</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">358</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2021-02-18</td>
<td>10039804.0</td>
<td>53479.0</td>
<td>45188.143</td>
<td>243752.0</td>
<td>1439.0</td>
<td>1032.714</td>
<td>46916.410</td>
<td>249.910</td>
<td>211.166</td>
<td>1139.063</td>
<td>6.725</td>
<td>4.826</td>
<td>1.02</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>33829.0</td>
<td>33909730.0</td>
<td>158.462</td>
<td>0.158</td>
<td>66854.0</td>
<td>0.312</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>6535156.0</td>
<td>5640483.0</td>
<td>894673.0</td>
<td>NaN</td>
<td>328476.0</td>
<td>262717.0</td>
<td>3.05</td>
<td>2.64</td>
<td>0.42</td>
<td>NaN</td>
<td>1228.0</td>
<td>150602.0</td>
<td>0.070</td>
<td>73.61</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">359</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2021-02-19</td>
<td>10091961.0</td>
<td>52157.0</td>
<td>45647.429</td>
<td>245083.0</td>
<td>1331.0</td>
<td>1048.571</td>
<td>47160.142</td>
<td>243.732</td>
<td>213.312</td>
<td>1145.283</td>
<td>6.220</td>
<td>4.900</td>
<td>1.04</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>108909.0</td>
<td>34018639.0</td>
<td>158.970</td>
<td>0.509</td>
<td>59659.0</td>
<td>0.279</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>6813168.0</td>
<td>5756361.0</td>
<td>1056807.0</td>
<td>NaN</td>
<td>278012.0</td>
<td>241137.0</td>
<td>3.18</td>
<td>2.69</td>
<td>0.49</td>
<td>NaN</td>
<td>1127.0</td>
<td>115660.0</td>
<td>0.054</td>
<td>73.61</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">360</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2021-02-20</td>
<td>10144332.0</td>
<td>52371.0</td>
<td>46721.000</td>
<td>246114.0</td>
<td>1031.0</td>
<td>1049.429</td>
<td>47404.873</td>
<td>244.732</td>
<td>218.329</td>
<td>1150.101</td>
<td>4.818</td>
<td>4.904</td>
<td>1.06</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>128106.0</td>
<td>34146745.0</td>
<td>159.569</td>
<td>0.599</td>
<td>69117.0</td>
<td>0.323</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>6950802.0</td>
<td>5817908.0</td>
<td>1132894.0</td>
<td>NaN</td>
<td>137634.0</td>
<td>244837.0</td>
<td>3.25</td>
<td>2.72</td>
<td>0.53</td>
<td>NaN</td>
<td>1144.0</td>
<td>110742.0</td>
<td>0.052</td>
<td>73.61</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">361</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2021-02-21</td>
<td>10173817.0</td>
<td>29485.0</td>
<td>46544.143</td>
<td>246720.0</td>
<td>606.0</td>
<td>1042.714</td>
<td>47542.658</td>
<td>137.785</td>
<td>217.503</td>
<td>1152.933</td>
<td>2.832</td>
<td>4.873</td>
<td>1.07</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>28496.0</td>
<td>34175241.0</td>
<td>159.702</td>
<td>0.133</td>
<td>66623.0</td>
<td>0.311</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>7028356.0</td>
<td>5857080.0</td>
<td>1171276.0</td>
<td>NaN</td>
<td>77554.0</td>
<td>247768.0</td>
<td>3.28</td>
<td>2.74</td>
<td>0.55</td>
<td>NaN</td>
<td>1158.0</td>
<td>111567.0</td>
<td>0.052</td>
<td>73.61</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">362</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2021-02-22</td>
<td>10205663.0</td>
<td>31846.0</td>
<td>47406.714</td>
<td>247431.0</td>
<td>711.0</td>
<td>1057.000</td>
<td>47691.476</td>
<td>148.818</td>
<td>221.533</td>
<td>1156.255</td>
<td>3.323</td>
<td>4.939</td>
<td>1.08</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>9041.0</td>
<td>34184282.0</td>
<td>159.745</td>
<td>0.042</td>
<td>63283.0</td>
<td>0.296</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>7297061.0</td>
<td>6002873.0</td>
<td>1294188.0</td>
<td>NaN</td>
<td>268705.0</td>
<td>241018.0</td>
<td>3.41</td>
<td>2.81</td>
<td>0.60</td>
<td>NaN</td>
<td>1126.0</td>
<td>96937.0</td>
<td>0.045</td>
<td>73.61</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-01</td>
<td>28818850.0</td>
<td>22279.0</td>
<td>65271.286</td>
<td>649922.0</td>
<td>246.0</td>
<td>598.143</td>
<td>134671.651</td>
<td>104.111</td>
<td>305.015</td>
<td>3037.112</td>
<td>1.150</td>
<td>2.795</td>
<td>0.48</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>19430.0</td>
<td>0.091</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>392925626.0</td>
<td>177836868.0</td>
<td>155071690.0</td>
<td>65073212.0</td>
<td>161992.0</td>
<td>814209.0</td>
<td>183.62</td>
<td>83.10</td>
<td>72.47</td>
<td>30.41</td>
<td>3805.0</td>
<td>173043.0</td>
<td>0.081</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-02</td>
<td>28846495.0</td>
<td>27645.0</td>
<td>50451.286</td>
<td>650254.0</td>
<td>332.0</td>
<td>505.714</td>
<td>134800.837</td>
<td>129.186</td>
<td>235.761</td>
<td>3038.663</td>
<td>1.551</td>
<td>2.363</td>
<td>0.45</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>19430.0</td>
<td>0.091</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>744548.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3479.0</td>
<td>141712.0</td>
<td>0.066</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-03</td>
<td>28906672.0</td>
<td>60177.0</td>
<td>45348.143</td>
<td>650824.0</td>
<td>570.0</td>
<td>445.857</td>
<td>135082.047</td>
<td>281.210</td>
<td>211.914</td>
<td>3041.327</td>
<td>2.664</td>
<td>2.084</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>69951873.0</td>
<td>326.888</td>
<td>NaN</td>
<td>19430.0</td>
<td>0.091</td>
<td>NaN</td>
<td>NaN</td>
<td>tests performed</td>
<td>394111796.0</td>
<td>177987744.0</td>
<td>155380086.0</td>
<td>65802661.0</td>
<td>NaN</td>
<td>623346.0</td>
<td>184.17</td>
<td>83.17</td>
<td>72.61</td>
<td>30.75</td>
<td>2913.0</td>
<td>116179.0</td>
<td>0.054</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-04</td>
<td>28978052.0</td>
<td>71380.0</td>
<td>42625.857</td>
<td>651522.0</td>
<td>698.0</td>
<td>432.286</td>
<td>135415.608</td>
<td>333.562</td>
<td>199.192</td>
<td>3044.589</td>
<td>3.262</td>
<td>2.020</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>394812859.0</td>
<td>178113009.0</td>
<td>155569412.0</td>
<td>66190014.0</td>
<td>701063.0</td>
<td>508531.0</td>
<td>184.50</td>
<td>83.23</td>
<td>72.70</td>
<td>30.93</td>
<td>2376.0</td>
<td>94869.0</td>
<td>0.044</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2022-03-05</td>
<td>29040800.0</td>
<td>62748.0</td>
<td>41606.857</td>
<td>652216.0</td>
<td>694.0</td>
<td>433.143</td>
<td>135708.832</td>
<td>293.224</td>
<td>194.431</td>
<td>3047.832</td>
<td>3.243</td>
<td>2.024</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>395464826.0</td>
<td>178203894.0</td>
<td>155711613.0</td>
<td>66609966.0</td>
<td>651967.0</td>
<td>525686.0</td>
<td>184.80</td>
<td>83.28</td>
<td>72.76</td>
<td>31.13</td>
<td>2457.0</td>
<td>94157.0</td>
<td>0.044</td>
<td>NaN</td>
<td>213993441.0</td>
<td>25.04</td>
<td>33.5</td>
<td>8.552</td>
<td>5.06</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.2</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>381 rows × 67 columns</p>
</div>
</div>
</div>
<ul>
<li>Selecionar os dados do Brasil e Estados Unidos</li>
</ul>
<div id="e724519f" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_covid[df_covid[<span class="st">'iso_code'</span>].isin([<span class="st">'BRA'</span>,<span class="st">'USA'</span>])]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed</th>
<th data-quarto-table-cell-role="th">total_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">new_cases_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">total_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_per_million</th>
<th data-quarto-table-cell-role="th">new_deaths_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">reproduction_rate</th>
<th data-quarto-table-cell-role="th">icu_patients</th>
<th data-quarto-table-cell-role="th">icu_patients_per_million</th>
<th data-quarto-table-cell-role="th">hosp_patients</th>
<th data-quarto-table-cell-role="th">hosp_patients_per_million</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions</th>
<th data-quarto-table-cell-role="th">weekly_icu_admissions_per_million</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions</th>
<th data-quarto-table-cell-role="th">weekly_hosp_admissions_per_million</th>
<th data-quarto-table-cell-role="th">new_tests</th>
<th data-quarto-table-cell-role="th">total_tests</th>
<th data-quarto-table-cell-role="th">total_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_per_thousand</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed</th>
<th data-quarto-table-cell-role="th">new_tests_smoothed_per_thousand</th>
<th data-quarto-table-cell-role="th">positive_rate</th>
<th data-quarto-table-cell-role="th">tests_per_case</th>
<th data-quarto-table-cell-role="th">tests_units</th>
<th data-quarto-table-cell-role="th">total_vaccinations</th>
<th data-quarto-table-cell-role="th">people_vaccinated</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated</th>
<th data-quarto-table-cell-role="th">total_boosters</th>
<th data-quarto-table-cell-role="th">new_vaccinations</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed</th>
<th data-quarto-table-cell-role="th">total_vaccinations_per_hundred</th>
<th data-quarto-table-cell-role="th">people_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">people_fully_vaccinated_per_hundred</th>
<th data-quarto-table-cell-role="th">total_boosters_per_hundred</th>
<th data-quarto-table-cell-role="th">new_vaccinations_smoothed_per_million</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed</th>
<th data-quarto-table-cell-role="th">new_people_vaccinated_smoothed_per_hundred</th>
<th data-quarto-table-cell-role="th">stringency_index</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">population_density</th>
<th data-quarto-table-cell-role="th">median_age</th>
<th data-quarto-table-cell-role="th">aged_65_older</th>
<th data-quarto-table-cell-role="th">aged_70_older</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">extreme_poverty</th>
<th data-quarto-table-cell-role="th">cardiovasc_death_rate</th>
<th data-quarto-table-cell-role="th">diabetes_prevalence</th>
<th data-quarto-table-cell-role="th">female_smokers</th>
<th data-quarto-table-cell-role="th">male_smokers</th>
<th data-quarto-table-cell-role="th">handwashing_facilities</th>
<th data-quarto-table-cell-role="th">hospital_beds_per_thousand</th>
<th data-quarto-table-cell-role="th">life_expectancy</th>
<th data-quarto-table-cell-role="th">human_development_index</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_absolute</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative</th>
<th data-quarto-table-cell-role="th">excess_mortality</th>
<th data-quarto-table-cell-role="th">excess_mortality_cumulative_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-26</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.005</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.040</td>
<td>33.5</td>
<td>8.552</td>
<td>5.060</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.20</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.040</td>
<td>33.5</td>
<td>8.552</td>
<td>5.060</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.20</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-28</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.005</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.040</td>
<td>33.5</td>
<td>8.552</td>
<td>5.060</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.20</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-02-29</td>
<td>2.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.009</td>
<td>0.005</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.040</td>
<td>33.5</td>
<td>8.552</td>
<td>5.060</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.20</td>
<td>75.88</td>
<td>0.765</td>
<td>7049.6</td>
<td>3.31</td>
<td>5.25</td>
<td>32.943066</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>2020-03-01</td>
<td>2.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.009</td>
<td>0.000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5.56</td>
<td>213993441.0</td>
<td>25.040</td>
<td>33.5</td>
<td>8.552</td>
<td>5.060</td>
<td>14103.452</td>
<td>3.4</td>
<td>177.961</td>
<td>8.11</td>
<td>10.1</td>
<td>17.9</td>
<td>NaN</td>
<td>2.20</td>
<td>75.88</td>
<td>0.765</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7658</th>
<td>USA</td>
<td>North America</td>
<td>United States</td>
<td>2022-03-01</td>
<td>79091361.0</td>
<td>47031.0</td>
<td>62331.429</td>
<td>952423.0</td>
<td>1691.0</td>
<td>1830.000</td>
<td>237572.183</td>
<td>141.270</td>
<td>187.229</td>
<td>2860.859</td>
<td>5.079</td>
<td>5.497</td>
<td>0.59</td>
<td>7314.0</td>
<td>21.970</td>
<td>36214.0</td>
<td>108.778</td>
<td>NaN</td>
<td>NaN</td>
<td>32132.0</td>
<td>96.517</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>554475530.0</td>
<td>253899142.0</td>
<td>215166280.0</td>
<td>94753028.0</td>
<td>241635.0</td>
<td>264689.0</td>
<td>167.01</td>
<td>76.47</td>
<td>64.81</td>
<td>28.54</td>
<td>797.0</td>
<td>69472.0</td>
<td>0.021</td>
<td>NaN</td>
<td>332915074.0</td>
<td>35.608</td>
<td>38.3</td>
<td>15.413</td>
<td>9.732</td>
<td>54225.446</td>
<td>1.2</td>
<td>151.089</td>
<td>10.79</td>
<td>19.1</td>
<td>24.6</td>
<td>NaN</td>
<td>2.77</td>
<td>78.86</td>
<td>0.926</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7659</th>
<td>USA</td>
<td>North America</td>
<td>United States</td>
<td>2022-03-02</td>
<td>79143716.0</td>
<td>52355.0</td>
<td>57824.857</td>
<td>954518.0</td>
<td>2095.0</td>
<td>1725.000</td>
<td>237729.446</td>
<td>157.262</td>
<td>173.693</td>
<td>2867.152</td>
<td>6.293</td>
<td>5.182</td>
<td>0.59</td>
<td>6993.0</td>
<td>21.005</td>
<td>34699.0</td>
<td>104.228</td>
<td>NaN</td>
<td>NaN</td>
<td>30821.0</td>
<td>92.579</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>554692730.0</td>
<td>253956787.0</td>
<td>215226511.0</td>
<td>94847407.0</td>
<td>217200.0</td>
<td>250409.0</td>
<td>167.07</td>
<td>76.49</td>
<td>64.83</td>
<td>28.57</td>
<td>754.0</td>
<td>65798.0</td>
<td>0.020</td>
<td>NaN</td>
<td>332915074.0</td>
<td>35.608</td>
<td>38.3</td>
<td>15.413</td>
<td>9.732</td>
<td>54225.446</td>
<td>1.2</td>
<td>151.089</td>
<td>10.79</td>
<td>19.1</td>
<td>24.6</td>
<td>NaN</td>
<td>2.77</td>
<td>78.86</td>
<td>0.926</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7660</th>
<td>USA</td>
<td>North America</td>
<td>United States</td>
<td>2022-03-03</td>
<td>79196008.0</td>
<td>52292.0</td>
<td>55673.857</td>
<td>956261.0</td>
<td>1743.0</td>
<td>1553.714</td>
<td>237886.519</td>
<td>157.073</td>
<td>167.231</td>
<td>2872.387</td>
<td>5.236</td>
<td>4.667</td>
<td>NaN</td>
<td>7015.0</td>
<td>21.071</td>
<td>34108.0</td>
<td>102.453</td>
<td>NaN</td>
<td>NaN</td>
<td>29613.0</td>
<td>88.951</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>554842009.0</td>
<td>253995527.0</td>
<td>215266826.0</td>
<td>94914378.0</td>
<td>149279.0</td>
<td>228576.0</td>
<td>167.12</td>
<td>76.50</td>
<td>64.84</td>
<td>28.59</td>
<td>688.0</td>
<td>60181.0</td>
<td>0.018</td>
<td>NaN</td>
<td>332915074.0</td>
<td>35.608</td>
<td>38.3</td>
<td>15.413</td>
<td>9.732</td>
<td>54225.446</td>
<td>1.2</td>
<td>151.089</td>
<td>10.79</td>
<td>19.1</td>
<td>24.6</td>
<td>NaN</td>
<td>2.77</td>
<td>78.86</td>
<td>0.926</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7661</th>
<td>USA</td>
<td>North America</td>
<td>United States</td>
<td>2022-03-04</td>
<td>79250509.0</td>
<td>54501.0</td>
<td>52764.286</td>
<td>958144.0</td>
<td>1883.0</td>
<td>1497.857</td>
<td>238050.227</td>
<td>163.708</td>
<td>158.492</td>
<td>2878.043</td>
<td>5.656</td>
<td>4.499</td>
<td>NaN</td>
<td>6203.0</td>
<td>18.632</td>
<td>30560.0</td>
<td>91.795</td>
<td>NaN</td>
<td>NaN</td>
<td>28778.0</td>
<td>86.442</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>554868239.0</td>
<td>254002347.0</td>
<td>215274110.0</td>
<td>94925621.0</td>
<td>26230.0</td>
<td>180572.0</td>
<td>167.12</td>
<td>76.50</td>
<td>64.84</td>
<td>28.59</td>
<td>544.0</td>
<td>48110.0</td>
<td>0.014</td>
<td>NaN</td>
<td>332915074.0</td>
<td>35.608</td>
<td>38.3</td>
<td>15.413</td>
<td>9.732</td>
<td>54225.446</td>
<td>1.2</td>
<td>151.089</td>
<td>10.79</td>
<td>19.1</td>
<td>24.6</td>
<td>NaN</td>
<td>2.77</td>
<td>78.86</td>
<td>0.926</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7662</th>
<td>USA</td>
<td>North America</td>
<td>United States</td>
<td>2022-03-05</td>
<td>79265726.0</td>
<td>15217.0</td>
<td>47989.857</td>
<td>958437.0</td>
<td>293.0</td>
<td>1425.714</td>
<td>238095.936</td>
<td>45.708</td>
<td>144.150</td>
<td>2878.923</td>
<td>0.880</td>
<td>4.283</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>554868239.0</td>
<td>254002347.0</td>
<td>215274110.0</td>
<td>94925621.0</td>
<td>0.0</td>
<td>148251.0</td>
<td>167.12</td>
<td>76.50</td>
<td>64.84</td>
<td>28.59</td>
<td>447.0</td>
<td>39094.0</td>
<td>0.012</td>
<td>NaN</td>
<td>332915074.0</td>
<td>35.608</td>
<td>38.3</td>
<td>15.413</td>
<td>9.732</td>
<td>54225.446</td>
<td>1.2</td>
<td>151.089</td>
<td>10.79</td>
<td>19.1</td>
<td>24.6</td>
<td>NaN</td>
<td>2.77</td>
<td>78.86</td>
<td>0.926</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>1513 rows × 67 columns</p>
</div>
</div>
</div>
</section>
<section id="operações-com-colunas-numéricas" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="operações-com-colunas-numéricas"><span class="header-section-number">8.3.4</span> Operações com colunas numéricas</h3>
<p>Criar novas colunas a partir de operações sobre aquelas que já existem é bastante simples. Além disso, vamos manter apenas os dados para o Brasil para melhor visualizar os resultados.</p>
<div id="b07729f6" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_covid_br <span class="op">=</span> df_covid[df_covid[<span class="st">'iso_code'</span>]<span class="op">==</span><span class="st">'BRA'</span>].reset_index()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Agora já podemos brincar com as colunas numéricas e mostrar o resultado dos cálculos.</p>
<ul>
<li>Coluna com o aumento percentual de casos a cada dia</li>
</ul>
<div id="3960a044" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'new_cases_percentage'</span>] <span class="op">=</span> df_covid_br[<span class="st">'new_cases'</span>] <span class="op">/</span> df_covid_br[<span class="st">'total_cases'</span>]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>columns_to_show <span class="op">=</span> [<span class="st">'date'</span>,<span class="st">'total_cases'</span>,<span class="st">'new_cases'</span>,<span class="st">'new_cases_percentage'</span>]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>df_covid_br[columns_to_show]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2020-02-26</td>
<td>1.0</td>
<td>1.0</td>
<td>1.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.0</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2020-02-28</td>
<td>1.0</td>
<td>0.0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2020-02-29</td>
<td>2.0</td>
<td>1.0</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2020-03-01</td>
<td>2.0</td>
<td>0.0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>2022-03-01</td>
<td>28818850.0</td>
<td>22279.0</td>
<td>0.000773</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>2022-03-02</td>
<td>28846495.0</td>
<td>27645.0</td>
<td>0.000958</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>2022-03-03</td>
<td>28906672.0</td>
<td>60177.0</td>
<td>0.002082</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>2022-03-04</td>
<td>28978052.0</td>
<td>71380.0</td>
<td>0.002463</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>2022-03-05</td>
<td>29040800.0</td>
<td>62748.0</td>
<td>0.002161</td>
</tr>
</tbody>
</table>

<p>739 rows × 4 columns</p>
</div>
</div>
</div>
<ul>
<li>Coluna com o log do total de casos</li>
</ul>
<div id="561ee1fb" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'log_total_cases'</span>] <span class="op">=</span> np.log(df_covid_br[<span class="st">'total_cases'</span>])</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>columns_to_show <span class="op">=</span> [<span class="st">'date'</span>,<span class="st">'total_cases'</span>,<span class="st">'log_total_cases'</span>]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>df_covid_br[columns_to_show]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">log_total_cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2020-02-26</td>
<td>1.0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2020-02-28</td>
<td>1.0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2020-02-29</td>
<td>2.0</td>
<td>0.693147</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2020-03-01</td>
<td>2.0</td>
<td>0.693147</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>2022-03-01</td>
<td>28818850.0</td>
<td>17.176540</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>2022-03-02</td>
<td>28846495.0</td>
<td>17.177499</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>2022-03-03</td>
<td>28906672.0</td>
<td>17.179583</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>2022-03-04</td>
<td>28978052.0</td>
<td>17.182049</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>2022-03-05</td>
<td>29040800.0</td>
<td>17.184212</td>
</tr>
</tbody>
</table>

<p>739 rows × 3 columns</p>
</div>
</div>
</div>
<ul>
<li>Coluna com o total de casos em milhares</li>
</ul>
<div id="ab3c2b92" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'total_cases_th'</span>] <span class="op">=</span> df_covid_br[<span class="st">'total_cases'</span>] <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>columns_to_show <span class="op">=</span> [<span class="st">'date'</span>,<span class="st">'total_cases'</span>,<span class="st">'total_cases_th'</span>]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>df_covid_br[columns_to_show]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">total_cases_th</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2020-02-26</td>
<td>1.0</td>
<td>0.001</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2020-02-27</td>
<td>1.0</td>
<td>0.001</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2020-02-28</td>
<td>1.0</td>
<td>0.001</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2020-02-29</td>
<td>2.0</td>
<td>0.002</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2020-03-01</td>
<td>2.0</td>
<td>0.002</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>2022-03-01</td>
<td>28818850.0</td>
<td>28818.850</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>2022-03-02</td>
<td>28846495.0</td>
<td>28846.495</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>2022-03-03</td>
<td>28906672.0</td>
<td>28906.672</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>2022-03-04</td>
<td>28978052.0</td>
<td>28978.052</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>2022-03-05</td>
<td>29040800.0</td>
<td>29040.800</td>
</tr>
</tbody>
</table>

<p>739 rows × 3 columns</p>
</div>
</div>
</div>
<ul>
<li>Subtrair a média do número de novos casos da coluna de novos casos para encontrar o desvio em relação à média.</li>
</ul>
<div id="d5a5162d" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'new_cases_demean'</span>] <span class="op">=</span> df_covid_br[<span class="st">'new_cases'</span>] <span class="op">-</span> df_covid_br[<span class="st">'new_cases'</span>].mean()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>columns_to_show <span class="op">=</span> [<span class="st">'date'</span>,<span class="st">'new_cases'</span>,<span class="st">'new_cases_demean'</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>df_covid_br[columns_to_show]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_demean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2020-02-26</td>
<td>1.0</td>
<td>-39260.489824</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2020-02-27</td>
<td>0.0</td>
<td>-39261.489824</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2020-02-28</td>
<td>0.0</td>
<td>-39261.489824</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2020-02-29</td>
<td>1.0</td>
<td>-39260.489824</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2020-03-01</td>
<td>0.0</td>
<td>-39261.489824</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>2022-03-01</td>
<td>22279.0</td>
<td>-16982.489824</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>2022-03-02</td>
<td>27645.0</td>
<td>-11616.489824</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>2022-03-03</td>
<td>60177.0</td>
<td>20915.510176</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>2022-03-04</td>
<td>71380.0</td>
<td>32118.510176</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>2022-03-05</td>
<td>62748.0</td>
<td>23486.510176</td>
</tr>
</tbody>
</table>

<p>739 rows × 3 columns</p>
</div>
</div>
</div>
<p>Para realizar outras operações simples de soma, subtração, multiplicação e divisão a lógica é a mesma, independente de ser uma operação entre colunas ou de uma coluna com um escalar. Para operações mais complexas, no entanto, o método <code>.apply</code> em conjunto com funções anônimas do tipo <code>lambda</code> constituem uma ferramenta poderosíssima.</p>
<ul>
<li>Elevar o número de novos casos ao quadrado e dividir o resultado por 1 milhão.</li>
</ul>
<div id="97a9d43d" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'total_cases_sq'</span>] <span class="op">=</span> df_covid_br[<span class="st">'total_cases'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: (x<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span> <span class="fl">1e6</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>columns_to_show <span class="op">=</span> [<span class="st">'date'</span>,<span class="st">'total_cases'</span>,<span class="st">'total_cases_sq'</span>]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>df_covid_br[columns_to_show]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">total_cases</th>
<th data-quarto-table-cell-role="th">total_cases_sq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2020-02-26</td>
<td>1.0</td>
<td>1.000000e-06</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2020-02-27</td>
<td>1.0</td>
<td>1.000000e-06</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2020-02-28</td>
<td>1.0</td>
<td>1.000000e-06</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2020-02-29</td>
<td>2.0</td>
<td>4.000000e-06</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2020-03-01</td>
<td>2.0</td>
<td>4.000000e-06</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>2022-03-01</td>
<td>28818850.0</td>
<td>8.305261e+08</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>2022-03-02</td>
<td>28846495.0</td>
<td>8.321203e+08</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>2022-03-03</td>
<td>28906672.0</td>
<td>8.355957e+08</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>2022-03-04</td>
<td>28978052.0</td>
<td>8.397275e+08</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>2022-03-05</td>
<td>29040800.0</td>
<td>8.433681e+08</td>
</tr>
</tbody>
</table>

<p>739 rows × 3 columns</p>
</div>
</div>
</div>
<p>Para visualizar melhor, vamos focar no último valor, representado pelo índice 738.</p>
<div id="2e01b229" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_covid_br.loc[<span class="dv">738</span>,<span class="st">'total_cases'</span>])</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_covid_br.loc[<span class="dv">738</span>,<span class="st">'total_cases_sq'</span>])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((df_covid_br.loc[<span class="dv">738</span>,<span class="st">'total_cases'</span>] <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">1000000</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>29040800.0
843368064.64
843368064.64</code></pre>
</div>
</div>
<p>Dei apenas exemplos super simples, mas note a força que o método <code>apply</code> tem quando trabalhado em conjunto com as funções <code>lambda</code>. O céu é o limite.</p>
</section>
<section id="operações-com-colunas-contendo-strings" class="level3" data-number="8.3.5">
<h3 data-number="8.3.5" class="anchored" data-anchor-id="operações-com-colunas-contendo-strings"><span class="header-section-number">8.3.5</span> Operações com colunas contendo strings</h3>
<p>O Pandas também nos fornece métodos e funções bastante interessantes para trabalhar com dados do tipo <code>string</code>. Vamos começar com um exemplo simples: transformando a nossa coluna com o nome dos países para um coluna com letras minúsculas apenas. Para trabalhar com essas funções/métodos precisamos primeiro dizer ao Pandas que a coluna de interesse receberá operações específicas a strings.</p>
<div id="ff78a7dd" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'lower_location'</span>] <span class="op">=</span> df_covid_br[<span class="st">'location'</span>].<span class="bu">str</span>.lower()</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>columns_to_show <span class="op">=</span> [<span class="st">'iso_code'</span>,<span class="st">'continent'</span>,<span class="st">'location'</span>,<span class="st">'lower_location'</span>,<span class="st">'date'</span>]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>df_covid_br[columns_to_show]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">lower_location</th>
<th data-quarto-table-cell-role="th">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-26</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-27</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-28</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-29</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-03-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-02</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-04</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>BRA</td>
<td>South America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-05</td>
</tr>
</tbody>
</table>

<p>739 rows × 5 columns</p>
</div>
</div>
</div>
<p>Podemos aplicar a maior parte dos métodos de strings que já vimos (<code>replace</code>,<code>starswith</code>,<code>strip</code>,<code>extract</code>, etc.) utilizando essa sintaxe. Uma outra operação interessante, para, por exemplo, separar em colunas distintas o primeiro e o último nome de uma pessoa é realizada através do método <code>split</code>. Vamos tentar fazer isso com a coluna do continente.</p>
<div id="f0ec8c57" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[[<span class="st">'continent_1'</span>, <span class="st">'continent_2'</span>]] <span class="op">=</span> df_covid_br[<span class="st">'continent'</span>].<span class="bu">str</span>.split(pat<span class="op">=</span><span class="st">' '</span>,n<span class="op">=</span><span class="dv">1</span>, expand<span class="op">=</span><span class="va">True</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>columns_to_show <span class="op">=</span> [<span class="st">'iso_code'</span>,<span class="st">'continent'</span>,<span class="st">'continent_1'</span>,<span class="st">'continent_2'</span>,<span class="st">'location'</span>,<span class="st">'lower_location'</span>,<span class="st">'date'</span>]</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>df_covid_br[columns_to_show]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso_code</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">continent_1</th>
<th data-quarto-table-cell-role="th">continent_2</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">lower_location</th>
<th data-quarto-table-cell-role="th">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-26</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-27</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-28</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-02-29</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2020-03-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-02</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-04</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>BRA</td>
<td>South America</td>
<td>South</td>
<td>America</td>
<td>Brazil</td>
<td>brazil</td>
<td>2022-03-05</td>
</tr>
</tbody>
</table>

<p>739 rows × 7 columns</p>
</div>
</div>
</div>
<p>Vamos olhar com calma esse resultado e os argumentos que utilizamos dentro do método <code>split</code>.</p>
<ul>
<li><em>pat</em>: determina os caracteres que serão utilizados para fazer a divisão do string.</li>
<li><em>n</em>: limita o número de divisões a serem feitas no string.</li>
<li><em>expand</em>: caso o valor desse argumento seja igual a <code>True</code>, a divisão do string irá gerar <em>n+1</em> novas colunas no dataframe.</li>
<li><em>regex</em>: determina se o padrão <em>pat</em>, utilizado para a divisão do string, deve ser entendido como uma expressão regular ou não.</li>
</ul>
<p>Bacana né? Esse método <code>split</code> nos permite fazer muita coisa legal com colunas de texto!</p>
<p>Por fim, uma outra funcionalidade interessante é a possibilidade de criação de novas colunas de strings utilizando dicionários. Podemos, por exemplo, utilizar essa funcionalidade para criar uma nova coluna que mostre se o número de novos casos por milhão está no quartil superior naquele dia ou não.</p>
<div id="2d140657" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'new_cases_per_million'</span>].describe()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>count     737.000000
mean      183.470531
std       173.332413
min         0.000000
25%        62.684000
50%       148.126000
75%       254.279000
max      1341.859000
Name: new_cases_per_million, dtype: float64</code></pre>
</div>
</div>
<div id="560d781c" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># criando coluna a partir de list comprehension</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'quartil_superior_bool'</span>] <span class="op">=</span> [<span class="va">True</span> <span class="cf">if</span> elem<span class="op">&gt;=</span><span class="fl">254.279</span> <span class="cf">else</span> <span class="va">False</span> <span class="cf">for</span> elem <span class="kw">in</span> df_covid_br[<span class="st">'new_cases_per_million'</span>]]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># criando coluna a partir de um dicionario</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>quartil_superior <span class="op">=</span> {</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">True</span>:<span class="st">'Acima do 3º quartil de novos casos por milhão'</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">False</span>:<span class="st">'Abaixo'</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>df_covid_br[<span class="st">'quartil_superior_cat'</span>] <span class="op">=</span> df_covid_br[<span class="st">'quartil_superior_bool'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: quartil_superior[x])</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>E qual é o resultado final?</p>
<div id="173328d8" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df_covid_br[[<span class="st">'date'</span>,<span class="st">'new_cases_per_million'</span>,<span class="st">'quartil_superior_bool'</span>,<span class="st">'quartil_superior_cat'</span>]]</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
<th data-quarto-table-cell-role="th">quartil_superior_bool</th>
<th data-quarto-table-cell-role="th">quartil_superior_cat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2020-02-26</td>
<td>0.005</td>
<td>False</td>
<td>Abaixo</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2020-02-27</td>
<td>0.000</td>
<td>False</td>
<td>Abaixo</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2020-02-28</td>
<td>0.000</td>
<td>False</td>
<td>Abaixo</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2020-02-29</td>
<td>0.005</td>
<td>False</td>
<td>Abaixo</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2020-03-01</td>
<td>0.000</td>
<td>False</td>
<td>Abaixo</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">734</th>
<td>2022-03-01</td>
<td>104.111</td>
<td>False</td>
<td>Abaixo</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">735</th>
<td>2022-03-02</td>
<td>129.186</td>
<td>False</td>
<td>Abaixo</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">736</th>
<td>2022-03-03</td>
<td>281.210</td>
<td>True</td>
<td>Acima do 3º quartil de novos casos por milhão</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">737</th>
<td>2022-03-04</td>
<td>333.562</td>
<td>True</td>
<td>Acima do 3º quartil de novos casos por milhão</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">738</th>
<td>2022-03-05</td>
<td>293.224</td>
<td>True</td>
<td>Acima do 3º quartil de novos casos por milhão</td>
</tr>
</tbody>
</table>

<p>739 rows × 4 columns</p>
</div>
</div>
</div>
</section>
<section id="agrupamento-e-junção-de-dataframes" class="level3" data-number="8.3.6">
<h3 data-number="8.3.6" class="anchored" data-anchor-id="agrupamento-e-junção-de-dataframes"><span class="header-section-number">8.3.6</span> Agrupamento e junção de DataFrames</h3>
<p>Suponha que queiramos calcular médias mensais de novos casos e novos casos por milhão e salvar isso em um novo dataframe. Para essa operação podemos utilizar o famoso <code>groupby</code>. Vamos fazer isso para os dados brasileiros e norte-americanos de forma separada.</p>
<div id="7cd83def" class="cell" data-execution_count="37">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df_covid[<span class="st">'ano_mes'</span>] <span class="op">=</span> df_covid[<span class="st">'date'</span>].<span class="bu">str</span>[<span class="dv">0</span>:<span class="dv">7</span>]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>columns_to_keep <span class="op">=</span> [<span class="st">'location'</span>,<span class="st">'ano_mes'</span>,<span class="st">'new_cases'</span>,<span class="st">'new_cases_per_million'</span>]</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>df_covid_br <span class="op">=</span> df_covid[df_covid[<span class="st">'iso_code'</span>]<span class="op">==</span><span class="st">'BRA'</span>][columns_to_keep]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>df_covid_us <span class="op">=</span> df_covid[df_covid[<span class="st">'iso_code'</span>]<span class="op">==</span><span class="st">'USA'</span>][columns_to_keep]</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>df_covid_br.head(<span class="dv">2</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">ano_mes</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02</td>
<td>1.0</td>
<td>0.005</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-02</td>
<td>0.0</td>
<td>0.000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="955b8920" class="cell" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df_covid_br_mensal <span class="op">=</span> df_covid_br.groupby(by<span class="op">=</span>[<span class="st">'location'</span>,<span class="st">'ano_mes'</span>], as_index<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df_covid_us_mensal <span class="op">=</span> df_covid_us.groupby(by<span class="op">=</span>[<span class="st">'location'</span>,<span class="st">'ano_mes'</span>], as_index<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>df_covid_br_mensal</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">ano_mes</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02</td>
<td>0.500000</td>
<td>0.002500</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-03</td>
<td>184.354839</td>
<td>0.861452</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Brazil</td>
<td>2020-04</td>
<td>2715.666667</td>
<td>12.690400</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Brazil</td>
<td>2020-05</td>
<td>13837.096774</td>
<td>64.661387</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Brazil</td>
<td>2020-06</td>
<td>31597.517241</td>
<td>147.656517</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Brazil</td>
<td>2020-07</td>
<td>40573.612903</td>
<td>189.602194</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Brazil</td>
<td>2020-08</td>
<td>40141.225806</td>
<td>187.581516</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Brazil</td>
<td>2020-09</td>
<td>30084.533333</td>
<td>140.586233</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Brazil</td>
<td>2020-10</td>
<td>23238.645161</td>
<td>108.595065</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Brazil</td>
<td>2020-11</td>
<td>26806.733333</td>
<td>125.268900</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Brazil</td>
<td>2020-12</td>
<td>43195.709677</td>
<td>201.855258</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Brazil</td>
<td>2021-01</td>
<td>49273.838710</td>
<td>230.258677</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>Brazil</td>
<td>2021-02</td>
<td>48198.928571</td>
<td>225.235607</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>Brazil</td>
<td>2021-03</td>
<td>71138.741935</td>
<td>332.434258</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>Brazil</td>
<td>2021-04</td>
<td>63723.733333</td>
<td>297.783600</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>Brazil</td>
<td>2021-05</td>
<td>60734.967742</td>
<td>283.817000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>Brazil</td>
<td>2021-06</td>
<td>67080.266667</td>
<td>313.468767</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>Brazil</td>
<td>2021-07</td>
<td>43608.064516</td>
<td>203.782323</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>Brazil</td>
<td>2021-08</td>
<td>27840.322581</td>
<td>130.098935</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>Brazil</td>
<td>2021-09</td>
<td>18009.931034</td>
<td>84.161034</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">20</th>
<td>Brazil</td>
<td>2021-10</td>
<td>12331.064516</td>
<td>57.623548</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21</th>
<td>Brazil</td>
<td>2021-11</td>
<td>9517.266667</td>
<td>44.474533</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">22</th>
<td>Brazil</td>
<td>2021-12</td>
<td>6183.741935</td>
<td>28.896806</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">23</th>
<td>Brazil</td>
<td>2022-01</td>
<td>102312.612903</td>
<td>478.111000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24</th>
<td>Brazil</td>
<td>2022-02</td>
<td>119037.178571</td>
<td>556.265607</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25</th>
<td>Brazil</td>
<td>2022-03</td>
<td>48845.800000</td>
<td>228.258600</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note que fizemos um dataframe para o Brasil e outro para os Estados Unidos. Podíamos ter feito tudo junto? Podíamos. Mas fizemos dessa forma justamente para mostrar outra funcionalidade bastante importante quando trabalhamos com bases de dados: a junção de duas bases diferentes. Essa junção de bases distintas pode ser realizada utilizando duas funções distintas: <code>concat</code> e <code>merge</code>.</p>
<p>A função <code>concat</code> “soma” duas bases, criando uma nova base que apenas junta as linhas dos diferentes dataframes. Isso é muito útil, por exemplo, quando geramos dataframes dentro de um loop e queremos ir juntando cada novo dataframe a um grande e único.</p>
<div id="c0212931" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df_covid_concat <span class="op">=</span> pd.concat(objs<span class="op">=</span>[df_covid_br_mensal, df_covid_us_mensal]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>df_covid_concat</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">ano_mes</th>
<th data-quarto-table-cell-role="th">new_cases</th>
<th data-quarto-table-cell-role="th">new_cases_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02</td>
<td>0.500000</td>
<td>0.002500</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-03</td>
<td>184.354839</td>
<td>0.861452</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Brazil</td>
<td>2020-04</td>
<td>2715.666667</td>
<td>12.690400</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Brazil</td>
<td>2020-05</td>
<td>13837.096774</td>
<td>64.661387</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Brazil</td>
<td>2020-06</td>
<td>31597.517241</td>
<td>147.656517</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Brazil</td>
<td>2020-07</td>
<td>40573.612903</td>
<td>189.602194</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Brazil</td>
<td>2020-08</td>
<td>40141.225806</td>
<td>187.581516</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Brazil</td>
<td>2020-09</td>
<td>30084.533333</td>
<td>140.586233</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Brazil</td>
<td>2020-10</td>
<td>23238.645161</td>
<td>108.595065</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Brazil</td>
<td>2020-11</td>
<td>26806.733333</td>
<td>125.268900</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Brazil</td>
<td>2020-12</td>
<td>43195.709677</td>
<td>201.855258</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Brazil</td>
<td>2021-01</td>
<td>49273.838710</td>
<td>230.258677</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>Brazil</td>
<td>2021-02</td>
<td>48198.928571</td>
<td>225.235607</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>Brazil</td>
<td>2021-03</td>
<td>71138.741935</td>
<td>332.434258</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>Brazil</td>
<td>2021-04</td>
<td>63723.733333</td>
<td>297.783600</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>Brazil</td>
<td>2021-05</td>
<td>60734.967742</td>
<td>283.817000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>Brazil</td>
<td>2021-06</td>
<td>67080.266667</td>
<td>313.468767</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>Brazil</td>
<td>2021-07</td>
<td>43608.064516</td>
<td>203.782323</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>Brazil</td>
<td>2021-08</td>
<td>27840.322581</td>
<td>130.098935</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>Brazil</td>
<td>2021-09</td>
<td>18009.931034</td>
<td>84.161034</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">20</th>
<td>Brazil</td>
<td>2021-10</td>
<td>12331.064516</td>
<td>57.623548</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21</th>
<td>Brazil</td>
<td>2021-11</td>
<td>9517.266667</td>
<td>44.474533</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">22</th>
<td>Brazil</td>
<td>2021-12</td>
<td>6183.741935</td>
<td>28.896806</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">23</th>
<td>Brazil</td>
<td>2022-01</td>
<td>102312.612903</td>
<td>478.111000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24</th>
<td>Brazil</td>
<td>2022-02</td>
<td>119037.178571</td>
<td>556.265607</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25</th>
<td>Brazil</td>
<td>2022-03</td>
<td>48845.800000</td>
<td>228.258600</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">26</th>
<td>United States</td>
<td>2020-01</td>
<td>0.777778</td>
<td>0.002333</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">27</th>
<td>United States</td>
<td>2020-02</td>
<td>0.586207</td>
<td>0.001759</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">28</th>
<td>United States</td>
<td>2020-03</td>
<td>6195.290323</td>
<td>18.609226</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">29</th>
<td>United States</td>
<td>2020-04</td>
<td>29444.100000</td>
<td>88.443333</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">30</th>
<td>United States</td>
<td>2020-05</td>
<td>22969.967742</td>
<td>68.996452</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">31</th>
<td>United States</td>
<td>2020-06</td>
<td>28578.766667</td>
<td>85.844033</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32</th>
<td>United States</td>
<td>2020-07</td>
<td>61294.612903</td>
<td>184.114871</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">33</th>
<td>United States</td>
<td>2020-08</td>
<td>48365.322581</td>
<td>145.278355</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">34</th>
<td>United States</td>
<td>2020-09</td>
<td>39903.133333</td>
<td>119.859833</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">35</th>
<td>United States</td>
<td>2020-10</td>
<td>61870.806452</td>
<td>185.845677</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">36</th>
<td>United States</td>
<td>2020-11</td>
<td>149008.733333</td>
<td>447.587733</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">37</th>
<td>United States</td>
<td>2020-12</td>
<td>211725.580645</td>
<td>635.974742</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">38</th>
<td>United States</td>
<td>2021-01</td>
<td>198457.129032</td>
<td>596.119355</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">39</th>
<td>United States</td>
<td>2021-02</td>
<td>86034.107143</td>
<td>258.426643</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">40</th>
<td>United States</td>
<td>2021-03</td>
<td>58529.064516</td>
<td>175.807742</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">41</th>
<td>United States</td>
<td>2021-04</td>
<td>62970.333333</td>
<td>189.148333</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">42</th>
<td>United States</td>
<td>2021-05</td>
<td>29748.451613</td>
<td>89.357484</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">43</th>
<td>United States</td>
<td>2021-06</td>
<td>13276.700000</td>
<td>39.880100</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">44</th>
<td>United States</td>
<td>2021-07</td>
<td>42530.483871</td>
<td>127.751742</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">45</th>
<td>United States</td>
<td>2021-08</td>
<td>138009.000000</td>
<td>414.547258</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">46</th>
<td>United States</td>
<td>2021-09</td>
<td>138317.100000</td>
<td>415.472700</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">47</th>
<td>United States</td>
<td>2021-10</td>
<td>80986.354839</td>
<td>243.264323</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">48</th>
<td>United States</td>
<td>2021-11</td>
<td>84910.433333</td>
<td>255.051300</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">49</th>
<td>United States</td>
<td>2021-12</td>
<td>200890.870968</td>
<td>603.429839</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">50</th>
<td>United States</td>
<td>2022-01</td>
<td>650778.903226</td>
<td>1954.789548</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">51</th>
<td>United States</td>
<td>2022-02</td>
<td>145005.857143</td>
<td>435.564107</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">52</th>
<td>United States</td>
<td>2022-03</td>
<td>44279.200000</td>
<td>133.004200</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Já a função <code>merge</code> une duas bases de acordo com colunas identificadoras. Vamos juntar as bases do Brasil e EUA utilizando a coluna de ano-mês como identificadora.</p>
<div id="b5ddcc42" class="cell" data-execution_count="40">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>df_covid_merge <span class="op">=</span> pd.merge(df_covid_br_mensal, df_covid_us_mensal, how<span class="op">=</span><span class="st">'inner'</span>, on<span class="op">=</span>[<span class="st">'ano_mes'</span>])</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>df_covid_merge</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location_x</th>
<th data-quarto-table-cell-role="th">ano_mes</th>
<th data-quarto-table-cell-role="th">new_cases_x</th>
<th data-quarto-table-cell-role="th">new_cases_per_million_x</th>
<th data-quarto-table-cell-role="th">location_y</th>
<th data-quarto-table-cell-role="th">new_cases_y</th>
<th data-quarto-table-cell-role="th">new_cases_per_million_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Brazil</td>
<td>2020-02</td>
<td>0.500000</td>
<td>0.002500</td>
<td>United States</td>
<td>0.586207</td>
<td>0.001759</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Brazil</td>
<td>2020-03</td>
<td>184.354839</td>
<td>0.861452</td>
<td>United States</td>
<td>6195.290323</td>
<td>18.609226</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Brazil</td>
<td>2020-04</td>
<td>2715.666667</td>
<td>12.690400</td>
<td>United States</td>
<td>29444.100000</td>
<td>88.443333</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Brazil</td>
<td>2020-05</td>
<td>13837.096774</td>
<td>64.661387</td>
<td>United States</td>
<td>22969.967742</td>
<td>68.996452</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Brazil</td>
<td>2020-06</td>
<td>31597.517241</td>
<td>147.656517</td>
<td>United States</td>
<td>28578.766667</td>
<td>85.844033</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Brazil</td>
<td>2020-07</td>
<td>40573.612903</td>
<td>189.602194</td>
<td>United States</td>
<td>61294.612903</td>
<td>184.114871</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Brazil</td>
<td>2020-08</td>
<td>40141.225806</td>
<td>187.581516</td>
<td>United States</td>
<td>48365.322581</td>
<td>145.278355</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Brazil</td>
<td>2020-09</td>
<td>30084.533333</td>
<td>140.586233</td>
<td>United States</td>
<td>39903.133333</td>
<td>119.859833</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Brazil</td>
<td>2020-10</td>
<td>23238.645161</td>
<td>108.595065</td>
<td>United States</td>
<td>61870.806452</td>
<td>185.845677</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Brazil</td>
<td>2020-11</td>
<td>26806.733333</td>
<td>125.268900</td>
<td>United States</td>
<td>149008.733333</td>
<td>447.587733</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Brazil</td>
<td>2020-12</td>
<td>43195.709677</td>
<td>201.855258</td>
<td>United States</td>
<td>211725.580645</td>
<td>635.974742</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Brazil</td>
<td>2021-01</td>
<td>49273.838710</td>
<td>230.258677</td>
<td>United States</td>
<td>198457.129032</td>
<td>596.119355</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>Brazil</td>
<td>2021-02</td>
<td>48198.928571</td>
<td>225.235607</td>
<td>United States</td>
<td>86034.107143</td>
<td>258.426643</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>Brazil</td>
<td>2021-03</td>
<td>71138.741935</td>
<td>332.434258</td>
<td>United States</td>
<td>58529.064516</td>
<td>175.807742</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>Brazil</td>
<td>2021-04</td>
<td>63723.733333</td>
<td>297.783600</td>
<td>United States</td>
<td>62970.333333</td>
<td>189.148333</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>Brazil</td>
<td>2021-05</td>
<td>60734.967742</td>
<td>283.817000</td>
<td>United States</td>
<td>29748.451613</td>
<td>89.357484</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>Brazil</td>
<td>2021-06</td>
<td>67080.266667</td>
<td>313.468767</td>
<td>United States</td>
<td>13276.700000</td>
<td>39.880100</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>Brazil</td>
<td>2021-07</td>
<td>43608.064516</td>
<td>203.782323</td>
<td>United States</td>
<td>42530.483871</td>
<td>127.751742</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>Brazil</td>
<td>2021-08</td>
<td>27840.322581</td>
<td>130.098935</td>
<td>United States</td>
<td>138009.000000</td>
<td>414.547258</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>Brazil</td>
<td>2021-09</td>
<td>18009.931034</td>
<td>84.161034</td>
<td>United States</td>
<td>138317.100000</td>
<td>415.472700</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">20</th>
<td>Brazil</td>
<td>2021-10</td>
<td>12331.064516</td>
<td>57.623548</td>
<td>United States</td>
<td>80986.354839</td>
<td>243.264323</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21</th>
<td>Brazil</td>
<td>2021-11</td>
<td>9517.266667</td>
<td>44.474533</td>
<td>United States</td>
<td>84910.433333</td>
<td>255.051300</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">22</th>
<td>Brazil</td>
<td>2021-12</td>
<td>6183.741935</td>
<td>28.896806</td>
<td>United States</td>
<td>200890.870968</td>
<td>603.429839</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">23</th>
<td>Brazil</td>
<td>2022-01</td>
<td>102312.612903</td>
<td>478.111000</td>
<td>United States</td>
<td>650778.903226</td>
<td>1954.789548</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24</th>
<td>Brazil</td>
<td>2022-02</td>
<td>119037.178571</td>
<td>556.265607</td>
<td>United States</td>
<td>145005.857143</td>
<td>435.564107</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25</th>
<td>Brazil</td>
<td>2022-03</td>
<td>48845.800000</td>
<td>228.258600</td>
<td>United States</td>
<td>44279.200000</td>
<td>133.004200</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Que legal! Tome um tempo em casa para entender as particularidades dessa função <code>merge</code>, elas são muitas.</p>
<p>Mas note que existiam colunas com o mesmo nome nas bases. Por padrão o pandas renomeia essas colunas com <code>_x</code> e <code>_y</code>. Vamos renomear essas colunas utilizando dicionários, uma forma alternativa ao que fizemos anteriormente.</p>
<div id="19871823" class="cell" data-execution_count="41">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df_covid_merge.drop(columns<span class="op">=</span>[<span class="st">'location_x'</span>,<span class="st">'location_y'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>dict_rename <span class="op">=</span> {</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'new_cases_x'</span>:<span class="st">'nc_br'</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'new_cases_per_million_x'</span>:<span class="st">'ncpm_br'</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'new_cases_y'</span>:<span class="st">'nc_us'</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'new_cases_per_million_y'</span>:<span class="st">'ncpm_us'</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>df_covid_merge.rename(columns<span class="op">=</span>dict_rename, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>df_covid_merge</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ano_mes</th>
<th data-quarto-table-cell-role="th">nc_br</th>
<th data-quarto-table-cell-role="th">ncpm_br</th>
<th data-quarto-table-cell-role="th">nc_us</th>
<th data-quarto-table-cell-role="th">ncpm_us</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2020-02</td>
<td>0.500000</td>
<td>0.002500</td>
<td>0.586207</td>
<td>0.001759</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2020-03</td>
<td>184.354839</td>
<td>0.861452</td>
<td>6195.290323</td>
<td>18.609226</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2020-04</td>
<td>2715.666667</td>
<td>12.690400</td>
<td>29444.100000</td>
<td>88.443333</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2020-05</td>
<td>13837.096774</td>
<td>64.661387</td>
<td>22969.967742</td>
<td>68.996452</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2020-06</td>
<td>31597.517241</td>
<td>147.656517</td>
<td>28578.766667</td>
<td>85.844033</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>2020-07</td>
<td>40573.612903</td>
<td>189.602194</td>
<td>61294.612903</td>
<td>184.114871</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>2020-08</td>
<td>40141.225806</td>
<td>187.581516</td>
<td>48365.322581</td>
<td>145.278355</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>2020-09</td>
<td>30084.533333</td>
<td>140.586233</td>
<td>39903.133333</td>
<td>119.859833</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>2020-10</td>
<td>23238.645161</td>
<td>108.595065</td>
<td>61870.806452</td>
<td>185.845677</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>2020-11</td>
<td>26806.733333</td>
<td>125.268900</td>
<td>149008.733333</td>
<td>447.587733</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>2020-12</td>
<td>43195.709677</td>
<td>201.855258</td>
<td>211725.580645</td>
<td>635.974742</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>2021-01</td>
<td>49273.838710</td>
<td>230.258677</td>
<td>198457.129032</td>
<td>596.119355</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>2021-02</td>
<td>48198.928571</td>
<td>225.235607</td>
<td>86034.107143</td>
<td>258.426643</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>2021-03</td>
<td>71138.741935</td>
<td>332.434258</td>
<td>58529.064516</td>
<td>175.807742</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>2021-04</td>
<td>63723.733333</td>
<td>297.783600</td>
<td>62970.333333</td>
<td>189.148333</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>2021-05</td>
<td>60734.967742</td>
<td>283.817000</td>
<td>29748.451613</td>
<td>89.357484</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>2021-06</td>
<td>67080.266667</td>
<td>313.468767</td>
<td>13276.700000</td>
<td>39.880100</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>2021-07</td>
<td>43608.064516</td>
<td>203.782323</td>
<td>42530.483871</td>
<td>127.751742</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>2021-08</td>
<td>27840.322581</td>
<td>130.098935</td>
<td>138009.000000</td>
<td>414.547258</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>2021-09</td>
<td>18009.931034</td>
<td>84.161034</td>
<td>138317.100000</td>
<td>415.472700</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">20</th>
<td>2021-10</td>
<td>12331.064516</td>
<td>57.623548</td>
<td>80986.354839</td>
<td>243.264323</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21</th>
<td>2021-11</td>
<td>9517.266667</td>
<td>44.474533</td>
<td>84910.433333</td>
<td>255.051300</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">22</th>
<td>2021-12</td>
<td>6183.741935</td>
<td>28.896806</td>
<td>200890.870968</td>
<td>603.429839</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">23</th>
<td>2022-01</td>
<td>102312.612903</td>
<td>478.111000</td>
<td>650778.903226</td>
<td>1954.789548</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24</th>
<td>2022-02</td>
<td>119037.178571</td>
<td>556.265607</td>
<td>145005.857143</td>
<td>435.564107</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25</th>
<td>2022-03</td>
<td>48845.800000</td>
<td>228.258600</td>
<td>44279.200000</td>
<td>133.004200</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="exportando-o-dataframe" class="level3" data-number="8.3.7">
<h3 data-number="8.3.7" class="anchored" data-anchor-id="exportando-o-dataframe"><span class="header-section-number">8.3.7</span> Exportando o DataFrame</h3>
<p>Por fim, a última coisa que gostaríamos de aprender nesse aulão de Pandas é como salvar o dataframe, resultado de todas as nossas operações, para um novo <code>csv</code> ou arquivo de qualquer outro tipo. Assim como tínhamos funções do tipo <code>read_csv</code> para trazer arquivos de fora, temos métodos do tipo <code>to_csv</code> para salvar um dado dataframe em um novo arquivo a ser utilizado em outros softwares.</p>
<p>A sintaxe é bastante simples:</p>
<div id="90fd6028" class="cell" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df_covid_merge.to_csv(<span class="st">'df_resultado_aula_pandas.csv'</span>, sep<span class="op">=</span><span class="st">','</span>, encoding<span class="op">=</span><span class="st">'utf8'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>os.listdir()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>['df_resultado_aula_pandas.csv',
 'EAE1106 - Aula Fundamentos.html',
 'EAE1106 - Aula Fundamentos.pdf',
 'EAE1106 - Aula Funções.html',
 'EAE1106 - Aula Funções.pdf',
 'EAE1106 - Aula Instalação.html',
 'EAE1106 - Aula Instalação.pdf',
 'EAE1106 - Aula Iteração.html',
 'EAE1106 - Aula Iteração.pdf',
 'EAE1106 - Aula Matplotlib.html',
 'EAE1106 - Aula Matplotlib.pdf',
 'EAE1106 - Aula NumPy.html',
 'EAE1106 - Aula NumPy.pdf',
 'EAE1106 - Aula Objetos.html',
 'EAE1106 - Aula Objetos.pdf',
 'EAE1106 - Aula Pandas.html',
 'EAE1106 - Aula Pandas.pdf',
 'EAE1106_Fundamentos_slides.aux',
 'EAE1106_Fundamentos_slides.log',
 'EAE1106_Fundamentos_slides.nav',
 'EAE1106_Fundamentos_slides.out',
 'EAE1106_Fundamentos_slides.pdf',
 'EAE1106_Fundamentos_slides.snm',
 'EAE1106_Fundamentos_slides.synctex.gz',
 'EAE1106_Fundamentos_slides.tex',
 'EAE1106_Fundamentos_slides.toc',
 'EAE1106_Introducao_slides.aux',
 'EAE1106_Introducao_slides.log',
 'EAE1106_Introducao_slides.nav',
 'EAE1106_Introducao_slides.out',
 'EAE1106_Introducao_slides.pdf',
 'EAE1106_Introducao_slides.snm',
 'EAE1106_Introducao_slides.synctex.gz',
 'EAE1106_Introducao_slides.tex',
 'EAE1106_Introducao_slides.toc',
 'notebook_images',
 'owid-covid-data_top10.csv']</code></pre>
</div>
</div>
<p>Olha o arquivo que geramos aí, minha gente!</p>
<p>Tente exportar o dataframe em outros formatos e importá-lo em outros softwares. Lembre-se, assim como quando queremos aprender novas línguas como inglês, alemão ou mandarim, em programação a fluência chega apenas com muito treino, tentativa e erro.</p>
</section>
</section>
<section id="eficiência-e-dtypes" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="eficiência-e-dtypes"><span class="header-section-number">8.4</span> Eficiência e <em>dtypes</em></h2>
<p>DataFrames podem ser objetos bastante pesados, com milhões de linhas e milhares de colunas. Isso por vezes pode ser um problemão para nós. Existem bibliotecas que servem ao propósito de trabalhar de forma mais eficiente com bases de dados muito grandes (e.g., <a href="https://www.dask.org/"><code>Dask</code></a>), mas algumas funções dentro do próprio Pandas já conseguem nos ajudar bastante em grande parte das situações.</p>
<p>Vamos começar relendo a base completa de dados da covid com os 10 países com o maior número de casos. Além disso, imagine que por um descuido nosso tenhamos replicado todas as entradas por 10 vezes seguidas. Qual é o tamanho dessa base e quantos bytes de memória foram alocados para esse objeto?</p>
<div id="92757460" class="cell" data-execution_count="43">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df_covid_duplicada <span class="op">=</span> pd.DataFrame()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>):</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    df_covid_duplicada <span class="op">=</span> pd.concat([df_covid_duplicada, df_covid]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>df_covid_duplicada.info(memory_usage<span class="op">=</span><span class="st">'deep'</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 76630 entries, 0 to 76629
Data columns (total 68 columns):
 #   Column                                      Non-Null Count  Dtype  
---  ------                                      --------------  -----  
 0   iso_code                                    76630 non-null  object 
 1   continent                                   76630 non-null  object 
 2   location                                    76630 non-null  object 
 3   date                                        76630 non-null  object 
 4   total_cases                                 76630 non-null  float64
 5   new_cases                                   76410 non-null  float64
 6   new_cases_smoothed                          74840 non-null  float64
 7   total_deaths                                73450 non-null  float64
 8   new_deaths                                  73270 non-null  float64
 9   new_deaths_smoothed                         71730 non-null  float64
 10  total_cases_per_million                     76630 non-null  float64
 11  new_cases_per_million                       76410 non-null  float64
 12  new_cases_smoothed_per_million              74840 non-null  float64
 13  total_deaths_per_million                    73450 non-null  float64
 14  new_deaths_per_million                      73270 non-null  float64
 15  new_deaths_smoothed_per_million             71730 non-null  float64
 16  reproduction_rate                           72920 non-null  float64
 17  icu_patients                                42780 non-null  float64
 18  icu_patients_per_million                    42780 non-null  float64
 19  hosp_patients                               28610 non-null  float64
 20  hosp_patients_per_million                   28610 non-null  float64
 21  weekly_icu_admissions                       13770 non-null  float64
 22  weekly_icu_admissions_per_million           13770 non-null  float64
 23  weekly_hosp_admissions                      36030 non-null  float64
 24  weekly_hosp_admissions_per_million          36030 non-null  float64
 25  new_tests                                   57550 non-null  float64
 26  total_tests                                 60560 non-null  float64
 27  total_tests_per_thousand                    60560 non-null  float64
 28  new_tests_per_thousand                      57550 non-null  float64
 29  new_tests_smoothed                          71160 non-null  float64
 30  new_tests_smoothed_per_thousand             71160 non-null  float64
 31  positive_rate                               58120 non-null  float64
 32  tests_per_case                              58120 non-null  float64
 33  tests_units                                 71860 non-null  object 
 34  total_vaccinations                          39500 non-null  float64
 35  people_vaccinated                           39380 non-null  float64
 36  people_fully_vaccinated                     38600 non-null  float64
 37  total_boosters                              20700 non-null  float64
 38  new_vaccinations                            38580 non-null  float64
 39  new_vaccinations_smoothed                   41810 non-null  float64
 40  total_vaccinations_per_hundred              39500 non-null  float64
 41  people_vaccinated_per_hundred               39380 non-null  float64
 42  people_fully_vaccinated_per_hundred         38600 non-null  float64
 43  total_boosters_per_hundred                  20700 non-null  float64
 44  new_vaccinations_smoothed_per_million       41810 non-null  float64
 45  new_people_vaccinated_smoothed              41810 non-null  float64
 46  new_people_vaccinated_smoothed_per_hundred  41810 non-null  float64
 47  stringency_index                            75800 non-null  float64
 48  population                                  76630 non-null  float64
 49  population_density                          76630 non-null  float64
 50  median_age                                  76630 non-null  float64
 51  aged_65_older                               76630 non-null  float64
 52  aged_70_older                               76630 non-null  float64
 53  gdp_per_capita                              76630 non-null  float64
 54  extreme_poverty                             53480 non-null  float64
 55  cardiovasc_death_rate                       76630 non-null  float64
 56  diabetes_prevalence                         76630 non-null  float64
 57  female_smokers                              76630 non-null  float64
 58  male_smokers                                76630 non-null  float64
 59  handwashing_facilities                      7660 non-null   float64
 60  hospital_beds_per_thousand                  76630 non-null  float64
 61  life_expectancy                             76630 non-null  float64
 62  human_development_index                     76630 non-null  float64
 63  excess_mortality_cumulative_absolute        6920 non-null   float64
 64  excess_mortality_cumulative                 6920 non-null   float64
 65  excess_mortality                            6920 non-null   float64
 66  excess_mortality_cumulative_per_million     6920 non-null   float64
 67  ano_mes                                     76630 non-null  object 
dtypes: float64(62), object(6)
memory usage: 61.2 MB</code></pre>
</div>
</div>
<p>O DataFrame <code>df_covid_duplicada</code> possui <span class="math inline">\(76,630\)</span> linhas, 67 colunas e está usando 64.6 MB da nossa memória RAM. O primeiro passo para tornar o objeto mais eficiente é ver se encontramos linhas duplicadas em todas suas colunas, que não nos trazem nenhuma nova informação mas carregam desnecessariamente nossos pentes de memória. Para esse fim utilizaremos a função <code>drop_duplicates</code>.</p>
<div id="a2224657" class="cell" data-execution_count="44">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_covid_duplicada.drop_duplicates(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>df_covid_duplicada.info(memory_usage<span class="op">=</span><span class="st">'deep'</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 7663 entries, 0 to 7662
Data columns (total 68 columns):
 #   Column                                      Non-Null Count  Dtype  
---  ------                                      --------------  -----  
 0   iso_code                                    7663 non-null   object 
 1   continent                                   7663 non-null   object 
 2   location                                    7663 non-null   object 
 3   date                                        7663 non-null   object 
 4   total_cases                                 7663 non-null   float64
 5   new_cases                                   7641 non-null   float64
 6   new_cases_smoothed                          7484 non-null   float64
 7   total_deaths                                7345 non-null   float64
 8   new_deaths                                  7327 non-null   float64
 9   new_deaths_smoothed                         7173 non-null   float64
 10  total_cases_per_million                     7663 non-null   float64
 11  new_cases_per_million                       7641 non-null   float64
 12  new_cases_smoothed_per_million              7484 non-null   float64
 13  total_deaths_per_million                    7345 non-null   float64
 14  new_deaths_per_million                      7327 non-null   float64
 15  new_deaths_smoothed_per_million             7173 non-null   float64
 16  reproduction_rate                           7292 non-null   float64
 17  icu_patients                                4278 non-null   float64
 18  icu_patients_per_million                    4278 non-null   float64
 19  hosp_patients                               2861 non-null   float64
 20  hosp_patients_per_million                   2861 non-null   float64
 21  weekly_icu_admissions                       1377 non-null   float64
 22  weekly_icu_admissions_per_million           1377 non-null   float64
 23  weekly_hosp_admissions                      3603 non-null   float64
 24  weekly_hosp_admissions_per_million          3603 non-null   float64
 25  new_tests                                   5755 non-null   float64
 26  total_tests                                 6056 non-null   float64
 27  total_tests_per_thousand                    6056 non-null   float64
 28  new_tests_per_thousand                      5755 non-null   float64
 29  new_tests_smoothed                          7116 non-null   float64
 30  new_tests_smoothed_per_thousand             7116 non-null   float64
 31  positive_rate                               5812 non-null   float64
 32  tests_per_case                              5812 non-null   float64
 33  tests_units                                 7186 non-null   object 
 34  total_vaccinations                          3950 non-null   float64
 35  people_vaccinated                           3938 non-null   float64
 36  people_fully_vaccinated                     3860 non-null   float64
 37  total_boosters                              2070 non-null   float64
 38  new_vaccinations                            3858 non-null   float64
 39  new_vaccinations_smoothed                   4181 non-null   float64
 40  total_vaccinations_per_hundred              3950 non-null   float64
 41  people_vaccinated_per_hundred               3938 non-null   float64
 42  people_fully_vaccinated_per_hundred         3860 non-null   float64
 43  total_boosters_per_hundred                  2070 non-null   float64
 44  new_vaccinations_smoothed_per_million       4181 non-null   float64
 45  new_people_vaccinated_smoothed              4181 non-null   float64
 46  new_people_vaccinated_smoothed_per_hundred  4181 non-null   float64
 47  stringency_index                            7580 non-null   float64
 48  population                                  7663 non-null   float64
 49  population_density                          7663 non-null   float64
 50  median_age                                  7663 non-null   float64
 51  aged_65_older                               7663 non-null   float64
 52  aged_70_older                               7663 non-null   float64
 53  gdp_per_capita                              7663 non-null   float64
 54  extreme_poverty                             5348 non-null   float64
 55  cardiovasc_death_rate                       7663 non-null   float64
 56  diabetes_prevalence                         7663 non-null   float64
 57  female_smokers                              7663 non-null   float64
 58  male_smokers                                7663 non-null   float64
 59  handwashing_facilities                      766 non-null    float64
 60  hospital_beds_per_thousand                  7663 non-null   float64
 61  life_expectancy                             7663 non-null   float64
 62  human_development_index                     7663 non-null   float64
 63  excess_mortality_cumulative_absolute        692 non-null    float64
 64  excess_mortality_cumulative                 692 non-null    float64
 65  excess_mortality                            692 non-null    float64
 66  excess_mortality_cumulative_per_million     692 non-null    float64
 67  ano_mes                                     7663 non-null   object 
dtypes: float64(62), object(6)
memory usage: 6.2 MB</code></pre>
</div>
</div>
<p>Legal, conseguimos dropar as linhas duplicadas e reduzimos o comprometimento de memória de 64.6 MB para 6.5MB.</p>
<p>No entanto, os tipos de dados de cada coluna não nos parecem os mais adequados. Uma coluna do tipo <code>float64</code> consume 4x mais memória do que uma coluna do tipo <code>float16</code> e 8x mais memória do que uma coluna do tipo <code>int8</code>, por exemplo. Da mesma forma, uma coluna do tipo <code>object</code> consome muito mais memória do que uma coluna que o Pandas entende como do tipo categórica em grande parte dos casos. Mas o que são esses tipos todos?</p>
<ul>
<li><strong>int8 / uint8</strong>: consome 1 byte (8-bit) de memória, o valor numérico deve ser inteiro e estar no intervalo <span class="math inline">\([-128 , 127]\)</span> / <span class="math inline">\([0 , 255]\)</span></li>
<li><strong>int16 / uint16</strong>: consome 2 bytes de memória, o valor numérico deve ser inteiro e estar no intervalo <span class="math inline">\([-32768 , 32768]\)</span> / <span class="math inline">\([0,65535]\)</span></li>
<li><strong>int32 / uint32</strong>: consome 4 bytes de memória e aceita valores numéricos inteiros com até 10 dígitos, da ordem de 2 bilhões.</li>
<li><strong>int64 / uint64</strong>: consome 8 bytes de memória e aceita valores numéricos inteiros ainda maiores.</li>
<li><strong>float16 / float32 / float64</strong>: consome 2, 4 e 8 bytes de memória, respectivamente, e aceita valores com casas decimais delimitado pelos mesmos intervalos dos tipos anteriores.</li>
<li><strong>bool</strong>: consome 1 byte de memória e aceita apenas dois valores <code>True</code> e <code>False</code>.</li>
<li><strong>object</strong>: o quanto consome de memória pode variar, mas, por aceitar valores numéricos e strings de todo tipo, consome ao menos 8 bytes de memória.</li>
<li><strong>category</strong>: o quanto consome de memória pode variar e depende da relação entre o número de valores únicos na coluna e o número de linhas de dados.</li>
</ul>
<p>Beleza, devemos fugir do tipo <code>object</code> e tentar reduzir as colunas numéricas para tipos menos demandantes em termos de memória. Como fazer isso? A função <code>astype</code> é nossa companheira nesse caso.</p>
<p>Voltando ao nosso dataframe original, as colunas <code>iso_code</code>, <code>continent</code> e <code>location</code> podem ser transformadas em colunas do tipo categórica sem nenhuma perda de informação. Comecemos por elas.</p>
<div id="55b13ab0" class="cell" data-execution_count="45">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>columns_to_cat <span class="op">=</span> [<span class="st">'iso_code'</span>,<span class="st">'continent'</span>,<span class="st">'location'</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> columns_to_cat:</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    df_covid_duplicada[c] <span class="op">=</span> df_covid_duplicada[c].astype(<span class="st">'category'</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>O quanto isso nos ajudou?</p>
<div id="6a32e72b" class="cell" data-execution_count="46">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df_covid_duplicada.info(memory_usage<span class="op">=</span><span class="st">'deep'</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 7663 entries, 0 to 7662
Data columns (total 68 columns):
 #   Column                                      Non-Null Count  Dtype   
---  ------                                      --------------  -----   
 0   iso_code                                    7663 non-null   category
 1   continent                                   7663 non-null   category
 2   location                                    7663 non-null   category
 3   date                                        7663 non-null   object  
 4   total_cases                                 7663 non-null   float64 
 5   new_cases                                   7641 non-null   float64 
 6   new_cases_smoothed                          7484 non-null   float64 
 7   total_deaths                                7345 non-null   float64 
 8   new_deaths                                  7327 non-null   float64 
 9   new_deaths_smoothed                         7173 non-null   float64 
 10  total_cases_per_million                     7663 non-null   float64 
 11  new_cases_per_million                       7641 non-null   float64 
 12  new_cases_smoothed_per_million              7484 non-null   float64 
 13  total_deaths_per_million                    7345 non-null   float64 
 14  new_deaths_per_million                      7327 non-null   float64 
 15  new_deaths_smoothed_per_million             7173 non-null   float64 
 16  reproduction_rate                           7292 non-null   float64 
 17  icu_patients                                4278 non-null   float64 
 18  icu_patients_per_million                    4278 non-null   float64 
 19  hosp_patients                               2861 non-null   float64 
 20  hosp_patients_per_million                   2861 non-null   float64 
 21  weekly_icu_admissions                       1377 non-null   float64 
 22  weekly_icu_admissions_per_million           1377 non-null   float64 
 23  weekly_hosp_admissions                      3603 non-null   float64 
 24  weekly_hosp_admissions_per_million          3603 non-null   float64 
 25  new_tests                                   5755 non-null   float64 
 26  total_tests                                 6056 non-null   float64 
 27  total_tests_per_thousand                    6056 non-null   float64 
 28  new_tests_per_thousand                      5755 non-null   float64 
 29  new_tests_smoothed                          7116 non-null   float64 
 30  new_tests_smoothed_per_thousand             7116 non-null   float64 
 31  positive_rate                               5812 non-null   float64 
 32  tests_per_case                              5812 non-null   float64 
 33  tests_units                                 7186 non-null   object  
 34  total_vaccinations                          3950 non-null   float64 
 35  people_vaccinated                           3938 non-null   float64 
 36  people_fully_vaccinated                     3860 non-null   float64 
 37  total_boosters                              2070 non-null   float64 
 38  new_vaccinations                            3858 non-null   float64 
 39  new_vaccinations_smoothed                   4181 non-null   float64 
 40  total_vaccinations_per_hundred              3950 non-null   float64 
 41  people_vaccinated_per_hundred               3938 non-null   float64 
 42  people_fully_vaccinated_per_hundred         3860 non-null   float64 
 43  total_boosters_per_hundred                  2070 non-null   float64 
 44  new_vaccinations_smoothed_per_million       4181 non-null   float64 
 45  new_people_vaccinated_smoothed              4181 non-null   float64 
 46  new_people_vaccinated_smoothed_per_hundred  4181 non-null   float64 
 47  stringency_index                            7580 non-null   float64 
 48  population                                  7663 non-null   float64 
 49  population_density                          7663 non-null   float64 
 50  median_age                                  7663 non-null   float64 
 51  aged_65_older                               7663 non-null   float64 
 52  aged_70_older                               7663 non-null   float64 
 53  gdp_per_capita                              7663 non-null   float64 
 54  extreme_poverty                             5348 non-null   float64 
 55  cardiovasc_death_rate                       7663 non-null   float64 
 56  diabetes_prevalence                         7663 non-null   float64 
 57  female_smokers                              7663 non-null   float64 
 58  male_smokers                                7663 non-null   float64 
 59  handwashing_facilities                      766 non-null    float64 
 60  hospital_beds_per_thousand                  7663 non-null   float64 
 61  life_expectancy                             7663 non-null   float64 
 62  human_development_index                     7663 non-null   float64 
 63  excess_mortality_cumulative_absolute        692 non-null    float64 
 64  excess_mortality_cumulative                 692 non-null    float64 
 65  excess_mortality                            692 non-null    float64 
 66  excess_mortality_cumulative_per_million     692 non-null    float64 
 67  ano_mes                                     7663 non-null   object  
dtypes: category(3), float64(62), object(3)
memory usage: 5.0 MB</code></pre>
</div>
</div>
<p>Caramba! Esse pequena alteração reduziu o comprometimento de memória em aproximadamente <span class="math inline">\(20\%\)</span>.</p>
<p>Vamos tentar transformar as colunas de <code>total_cases</code>, <code>new_cases</code>, <code>total_deaths</code> e <code>new_deaths</code> em colunas do tipo <code>int32</code> ao invés de <code>float64</code> já que são colunas sabidamente de números inteiros. Não esqueça de lidar com os valores missing antes, já que dados do tipo <code>int</code> não aceitam <code>NaN</code> ou <code>infty</code> como valores.</p>
<div id="3c34cb74" class="cell" data-execution_count="47">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>columns_to_int <span class="op">=</span> [<span class="st">'total_cases'</span>,<span class="st">'new_cases'</span>,<span class="st">'total_deaths'</span>,<span class="st">'new_deaths'</span>]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> columns_to_int:</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    df_covid_duplicada[c] <span class="op">=</span> df_covid_duplicada[c].fillna(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    df_covid_duplicada[c] <span class="op">=</span> df_covid_duplicada[c].astype(<span class="st">'int32'</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>O quanto isso nos ajudou?</p>
<div id="f857f2cf" class="cell" data-execution_count="48">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df_covid_duplicada.info(memory_usage<span class="op">=</span><span class="st">'deep'</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 7663 entries, 0 to 7662
Data columns (total 68 columns):
 #   Column                                      Non-Null Count  Dtype   
---  ------                                      --------------  -----   
 0   iso_code                                    7663 non-null   category
 1   continent                                   7663 non-null   category
 2   location                                    7663 non-null   category
 3   date                                        7663 non-null   object  
 4   total_cases                                 7663 non-null   int32   
 5   new_cases                                   7663 non-null   int32   
 6   new_cases_smoothed                          7484 non-null   float64 
 7   total_deaths                                7663 non-null   int32   
 8   new_deaths                                  7663 non-null   int32   
 9   new_deaths_smoothed                         7173 non-null   float64 
 10  total_cases_per_million                     7663 non-null   float64 
 11  new_cases_per_million                       7641 non-null   float64 
 12  new_cases_smoothed_per_million              7484 non-null   float64 
 13  total_deaths_per_million                    7345 non-null   float64 
 14  new_deaths_per_million                      7327 non-null   float64 
 15  new_deaths_smoothed_per_million             7173 non-null   float64 
 16  reproduction_rate                           7292 non-null   float64 
 17  icu_patients                                4278 non-null   float64 
 18  icu_patients_per_million                    4278 non-null   float64 
 19  hosp_patients                               2861 non-null   float64 
 20  hosp_patients_per_million                   2861 non-null   float64 
 21  weekly_icu_admissions                       1377 non-null   float64 
 22  weekly_icu_admissions_per_million           1377 non-null   float64 
 23  weekly_hosp_admissions                      3603 non-null   float64 
 24  weekly_hosp_admissions_per_million          3603 non-null   float64 
 25  new_tests                                   5755 non-null   float64 
 26  total_tests                                 6056 non-null   float64 
 27  total_tests_per_thousand                    6056 non-null   float64 
 28  new_tests_per_thousand                      5755 non-null   float64 
 29  new_tests_smoothed                          7116 non-null   float64 
 30  new_tests_smoothed_per_thousand             7116 non-null   float64 
 31  positive_rate                               5812 non-null   float64 
 32  tests_per_case                              5812 non-null   float64 
 33  tests_units                                 7186 non-null   object  
 34  total_vaccinations                          3950 non-null   float64 
 35  people_vaccinated                           3938 non-null   float64 
 36  people_fully_vaccinated                     3860 non-null   float64 
 37  total_boosters                              2070 non-null   float64 
 38  new_vaccinations                            3858 non-null   float64 
 39  new_vaccinations_smoothed                   4181 non-null   float64 
 40  total_vaccinations_per_hundred              3950 non-null   float64 
 41  people_vaccinated_per_hundred               3938 non-null   float64 
 42  people_fully_vaccinated_per_hundred         3860 non-null   float64 
 43  total_boosters_per_hundred                  2070 non-null   float64 
 44  new_vaccinations_smoothed_per_million       4181 non-null   float64 
 45  new_people_vaccinated_smoothed              4181 non-null   float64 
 46  new_people_vaccinated_smoothed_per_hundred  4181 non-null   float64 
 47  stringency_index                            7580 non-null   float64 
 48  population                                  7663 non-null   float64 
 49  population_density                          7663 non-null   float64 
 50  median_age                                  7663 non-null   float64 
 51  aged_65_older                               7663 non-null   float64 
 52  aged_70_older                               7663 non-null   float64 
 53  gdp_per_capita                              7663 non-null   float64 
 54  extreme_poverty                             5348 non-null   float64 
 55  cardiovasc_death_rate                       7663 non-null   float64 
 56  diabetes_prevalence                         7663 non-null   float64 
 57  female_smokers                              7663 non-null   float64 
 58  male_smokers                                7663 non-null   float64 
 59  handwashing_facilities                      766 non-null    float64 
 60  hospital_beds_per_thousand                  7663 non-null   float64 
 61  life_expectancy                             7663 non-null   float64 
 62  human_development_index                     7663 non-null   float64 
 63  excess_mortality_cumulative_absolute        692 non-null    float64 
 64  excess_mortality_cumulative                 692 non-null    float64 
 65  excess_mortality                            692 non-null    float64 
 66  excess_mortality_cumulative_per_million     692 non-null    float64 
 67  ano_mes                                     7663 non-null   object  
dtypes: category(3), float64(58), int32(4), object(3)
memory usage: 4.9 MB</code></pre>
</div>
</div>
<p>Reduzimos mais um pouco o comprometimento de memória, embora a diferença não tenha sido tão grande. Em dataframes com milhões de linhas e milhares de colunas, no entanto, essa redução pode fazer toda a diferença. Dica: dê uma olhada na função <code>pandas.to_numeric</code> e no argumento <code>downcast</code> caso você não saiba para qual tipo de dado numérico deve ir.</p>
<p>No fim das contas, parte importante da estratégia de otimização na gestão de memória de dataframes vem de conhecermos os tipos mais adequados de dados para cada coluna <strong>antes</strong> da leitura do dataframe. Isso pode ser feito lendo primeiro um amostra de poucas linhas (e.g., 10 ou 20) do dataframe com o qual iremos trabalhar para entender a base de dados e só a partir daí ler o dataframe completo com a função <code>read_csv</code> (ou similar) e passar uma lista de tipo de dados ao argumento <code>dtype</code> (exemplo do algoritmo <a href="https://vincentteyssier.medium.com/optimizing-the-size-of-a-pandas-dataframe-for-low-memory-environment-5f07db3d72e">aqui</a>). Tente isso em casa! <strong>E não se esqueça: fuja de dados do tipo <code>object</code>!</strong></p>
</section>
<section id="exercícios" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="exercícios"><span class="header-section-number">8.5</span> Exercícios</h2>
<ol type="1">
<li><p>X</p></li>
<li><p>X</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./numpy.html" class="pagination-link" aria-label="Arrays, matrizes e álgebra linear">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Arrays, matrizes e álgebra linear</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./visualizacao.html" class="pagination-link" aria-label="Visualização">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualização</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2026 <a href="https://www.danilosouza.com/">Danilo Souza</a> · Departamento de Economia · FEA-USP</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/danilosouza-usp/eae1106/edit/main/pandas.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li><li><a href="https://github.com/danilosouza-usp/eae1106/issues/new" class="toc-action"><i class="bi empty"></i>Criar uma issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Material da disciplina <strong>EAE1106 — Métodos Computacionais para Economia</strong> · Feito com <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>